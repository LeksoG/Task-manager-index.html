<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasklytic</title>
    <style>
        :root {
            /* Primary Colors */
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --primary-light: #818cf8;
            --primary-gradient: linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%);
            
            /* Secondary Colors */
            --secondary: #0ea5e9;
            --secondary-dark: #0284c7;
            --secondary-light: #7dd3fc;
            
            /* Accent Colors */
            --accent: #f97316;
            --accent-dark: #ea580c;
            --accent-light: #fdba74;
            
            /* Status Colors */
            --success: #10b981;
            --success-light: #d1fae5;
            --warning: #f59e0b;
            --warning-light: #fef3c7;
            --danger: #ef4444;
            --danger-light: #fee2e2;
            
            /* Gray Scale */
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-300: #d1d5db;
            --gray-400: #9ca3af;
            --gray-500: #6b7280;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
            
            /* Category Colors */
            --work-color: #4f46e5;
            --work-light: #e0e7ff;
            --personal-color: #8b5cf6;
            --personal-light: #ede9fe;
            --shopping-color: #06b6d4;
            --shopping-light: #cffafe;
            --health-color: #10b981;
            --health-light: #d1fae5;
            --finance-color: #f59e0b;
            --finance-light: #fef3c7;
            --education-color: #ef4444;
            --education-light: #fee2e2;
            
            /* Shadows */
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --card-shadow-hover: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --sidebar-shadow: 4px 0 10px -3px rgba(0, 0, 0, 0.1);

            /* Highlight Colors */
            --highlight-color: #ec4899;
            --highlight-light: #fce7f3;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            color: var(--gray-700);
            line-height: 1.7;
            background-color: var(--gray-50);
            min-height: 100vh;
            overflow-x: hidden;
            width: 100%;
            /* Prevent zoom on input focus for iOS */
            -webkit-text-size-adjust: 100%;
        }

        /* Typography */
        h1, h2, h3, h4, h5, h6 {
            color: var(--gray-800);
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .container {
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Improved Welcome Animation with Typing Effect */
        .welcome-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--gray-50);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            overflow: hidden;
        }

        /* Ring animation container */
        .welcome-container {
            position: relative;
            width: 200px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Task cards animation */
        .task-card {
            position: absolute;
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--primary);
            animation: float-animation 3s ease-in-out infinite;
            opacity: 0;
        }

        .task-card:nth-child(1) {
            background-color: var(--work-light);
            animation-delay: 0s;
            transform: translate(-80px, -80px);
        }

        .task-card:nth-child(2) {
            background-color: var(--personal-light);
            animation-delay: 0.7s;
            transform: translate(80px, -80px);
        }

        .task-card:nth-child(3) {
            background-color: var(--shopping-light);
            animation-delay: 1.4s;
            transform: translate(-80px, 80px);
        }

        .task-card:nth-child(4) {
            background-color: var(--health-light);
            animation-delay: 2.1s;
            transform: translate(80px, 80px);
        }

        @keyframes float-animation {
            0% {
                opacity: 0;
                transform: translate(var(--x, 0), var(--y, 0)) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translate(var(--x, 0), var(--y, 0)) scale(1);
            }
            80% {
                opacity: 1;
                transform: translate(var(--x, 0), var(--y, 0)) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(var(--x, 0), var(--y, 0)) scale(0.5);
            }
        }

        /* Typing animation for the app title */
        .app-title {
            position: relative;
            font-size: 3rem;
            font-weight: 700;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            opacity: 0;
            animation: fade-in 0.5s ease 0.5s forwards;
            white-space: nowrap;
            overflow: hidden;
            border-right: 0.15em solid var(--primary);
            width: 0;
            animation: typing 2.5s steps(10, end) 0.5s forwards, 
                       blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 10ch; }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: var(--primary); }
        }

        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .exclamation {
            color: var(--accent);
            display: inline-block;
            transform-origin: bottom;
            animation: bounce 0.5s ease 3s;
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-15px);
            }
        }

        /* App Container fade in effect */
        .app-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--gray-50);
            z-index: 1500;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .app-container.visible {
            opacity: 1;
            visibility: visible;
        }

        /* Header */
        header {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
            padding: 0.75rem 0;
            transition: background 0.3s ease;
            width: 100%;
        }

        header .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
        }

        .logo {
            font-size: 1.75rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.5px;
        }

        .logo i {
            margin-right: 0.75rem;
            font-size: 2rem;
            background: white;
            color: var(--primary);
            width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .theme-toggle {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        /* Main Content */
        .main-content {
            display: flex;
            margin-top: 1rem;
            gap: 2rem;
            height: calc(100vh - 90px);
            width: 100%;
            transition: all 0.3s ease-in-out;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            min-width: 280px;
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--sidebar-shadow);
            padding: 1.5rem 1rem;
            border: 1px solid var(--gray-200);
            position: sticky;
            top: 90px;
            height: calc(100vh - 120px);
            overflow-y: auto;
            transition: transform 0.4s ease, opacity 0.4s ease;
        }

        .sidebar-header {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-header h3 {
            font-size: 1.25rem;
            color: var(--gray-800);
        }

        /* Improved Category Selection with Sliding Indicator */
        .categories-container {
            position: relative;
            overflow: hidden;
        }

        .category-slider {
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Sliding Active Indicator */
        .active-category-indicator {
            position: absolute;
            left: 0;
            width: 100%;
            height: 58px; /* Match category height */
            background: var(--primary-gradient);
            border-radius: 10px;
            transition: transform 0.3s ease;
            z-index: 1;
            opacity: 0.9;
            pointer-events: none; /* Allow clicks to pass through */
        }

        .category {
            margin-bottom: 0.75rem;
            cursor: pointer;
            padding: 1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
            color: var(--gray-700);
            font-weight: 500;
            position: relative;
            z-index: 2; /* Place above the indicator */
        }

        .category:hover:not(.active) {
            background-color: rgba(79, 70, 229, 0.1);
            transform: translateX(5px);
        }

        .category.active {
            color: white;
        }

        .category-label {
            display: flex;
            align-items: center;
        }

        .category i {
            margin-right: 0.75rem;
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .task-count {
            background-color: rgba(255, 255, 255, 0.3);
            color: inherit;
            font-size: 0.75rem;
            font-weight: 600;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .category:not(.active) .task-count {
            background-color: var(--gray-200);
            color: var(--gray-700);
        }

        /* Tasks Container */
        .tasks-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: opacity 0.4s ease;
        }

        .tasks-header {
            margin-bottom: 1.5rem;
            position: relative;
            transition: transform 0.3s ease;
        }

        /* REDESIGNED SEARCH CONTAINER */
        .search-container {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 1.5rem;
            position: relative;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            z-index: 10;
        }

        .search-input {
            width: 100%;
            padding: 0.9rem 1rem 0.9rem 3rem;
            border: 1px solid var(--gray-300);
            border-radius: 30px;
            font-size: 1.1rem;
            background-color: white;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 1.2rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-500);
            font-size: 1.2rem;
            z-index: 2;
        }

        /* Search Overlay */
        .search-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 5;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .search-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Search Suggestions */
        .search-suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease, opacity 0.3s ease;
            opacity: 0;
            z-index: 20;
        }

        .search-suggestions.active {
            max-height: 300px;
            opacity: 1;
            overflow-y: auto;
            padding: 0.5rem 0;
        }

        .suggestion-item {
            padding: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.2s ease;
            cursor: pointer;
            border-left: 4px solid transparent;
        }

        .suggestion-item:hover {
            background-color: var(--gray-100);
        }

        .suggestion-content {
            flex: 1;
        }

        .suggestion-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .suggestion-category {
            font-size: 0.85rem;
            color: var(--gray-600);
            display: flex;
            align-items: center;
        }

        .suggestion-category i {
            margin-right: 0.25rem;
        }

        .suggestion-priority {
            padding: 0.25rem 0.5rem;
            border-radius: 30px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .priority-high {
            background-color: var(--danger-light);
            color: var(--danger);
        }

        .priority-medium {
            background-color: var(--warning-light);
            color: var(--warning);
        }

        .priority-low {
            background-color: var(--success-light);
            color: var(--success);
        }

        .suggestion-actions {
            display: flex;
            gap: 0.5rem;
        }

        .suggestion-action {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--gray-100);
            transition: all 0.2s ease;
            color: var(--gray-600);
            font-size: 0.9rem;
            border: none;
            cursor: pointer;
        }

        .suggestion-action:hover {
            color: white;
            transform: translateY(-2px);
        }

        .suggestion-action.edit:hover {
            background-color: var(--secondary);
        }

        .suggestion-action.delete:hover {
            background-color: var(--danger);
        }

        /* End of SEARCH REDESIGN */

        .section-title {
    display: flex;
    justify-content: space-between;
    align-items: flex-start; /* Change from center to flex-start */
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--gray-200);
    gap: 1rem; /* Add gap between elements */
}

.section-actions {
    display: flex;
    align-items: center;
    gap: 1rem; /* Add gap between buttons and sort dropdown */
}

/* ADD THIS NEW CSS HERE */
.task-controls {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 1rem;
    padding-right: 0.5rem;
}

.task-controls .btn {
    min-width: 120px;
}


        .section-title h2 {
            font-size: 1.75rem;
            color: var(--gray-800);
            position: relative;
            padding-left: 1rem;
            display: flex;
            align-items: center;
        }

        .section-title h2::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            height: 70%;
            width: 6px;
            background: var(--primary-gradient);
            border-radius: 3px;
            transition: background 0.3s ease;
        }

        .section-title h2 i {
            margin-right: 0.75rem;
            font-size: 1.75rem;
        }

        .category-description {
            color: var(--gray-600);
            margin-top: 0.5rem;
            font-size: 1.1rem;
        }

        /* Fixed at top when scrolling */
        .task-filters-wrapper {
            position: sticky;
            top: 70px;
            background-color: var(--gray-50);
            z-index: 20;
            padding: 1rem 0;
            margin-bottom: 1rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            transform: translateY(0);
            border-radius: 0 0 12px 12px;
        }

        .task-filters-wrapper.fixed {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .task-filters {
            display: flex;
            gap: 1rem;
        }

        .filter-btn {
            background-color: white;
            border: 1px solid var(--gray-300);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--gray-700);
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-btn.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .task-sort {
            display: flex;
            align-items: center;
            background-color: white;
            padding: 0.5rem 0.75rem;
            border-radius: 8px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--gray-200);
        }

        .sort-label {
            margin-right: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        /* Button Styles */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            letter-spacing: -0.01em;
            font-size: 1rem;
            /* Ensure buttons work well on touch devices */
            touch-action: manipulation;
            min-height: 44px; /* Apple recommended touch target size */
        }

        .btn-icon {
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(79, 70, 229, 0.4);
        }

        .btn-primary:active {
            transform: translateY(1px);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(14, 165, 233, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(14, 165, 233, 0.4);
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(239, 68, 68, 0.4);
        }

        .btn-cancel {
            background-color: var(--gray-200);
            color: var(--gray-700);
        }

        .btn-cancel:hover {
            background-color: var(--gray-300);
        }

        .btn-select {
            background-color: white;
            border: 1px solid var(--gray-300);
            padding: 0.5rem 2.5rem 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.95rem;
            appearance: none;
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%236b7280' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: calc(100% - 0.75rem) center;
            background-size: 14px;
            transition: all 0.3s ease;
        }

        .btn-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
        }

        /* Dashboard Section */
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
            opacity: 1;
            transform: translateY(0);
            transition: transform 0.5s ease, opacity 0.5s ease;
        }

        /* Hidden dashboard when scrolling */
        .dashboard.hidden {
            opacity: 0;
            transform: translateY(-20px);
            max-height: 0;
            margin: 0;
            overflow: hidden;
        }

        @keyframes fade-slide-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .stat-card {
            background-color: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--gray-200);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-shadow-hover);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .stat-title {
            font-size: 1.1rem;
            color: var(--gray-600);
            font-weight: 500;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .stat-icon.total {
            background-color: var(--primary);
        }

        .stat-icon.completed {
            background-color: var(--success);
        }

        .stat-icon.pending {
            background-color: var(--warning);
        }

        .stat-icon.overdue {
            background-color: var(--danger);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--gray-800);
            margin-bottom: 0.5rem;
        }

        .stat-change {
            display: flex;
            align-items: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .stat-change.positive {
            color: var(--success);
        }

        .stat-change.negative {
            color: var(--danger);
        }

        .stat-change i {
            margin-right: 0.25rem;
        }

        /* Task List */
        .task-list-wrapper {
            flex: 1;
            overflow-y: auto;
            padding-right: 0.5rem;
            opacity: 1;
            transform: translateY(0);
            transition: transform 0.3s ease, opacity 0.3s ease, padding-top 0.3s ease;
        }

        .task-list-wrapper.expanded {
            padding-top: 0;
        }

        .task-list {
            background-color: white;
            border-radius: 12px;
            box-shadow: var(--card-shadow);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid var(--gray-200);
            min-height: 300px;
            transition: opacity 0.3s ease;
        }

        /* Enhanced Task Item Styles */
        .task-item {
            display: flex;
            align-items: center;
            padding: 1.25rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            background-color: var(--gray-50);
            transition: all 0.3s ease;
            border: 1px solid var(--gray-200);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            cursor: pointer;
            animation: fade-in 0.5s ease-out, slide-in 0.5s ease-out;
            position: relative;
        }

        .task-item:hover {
            box-shadow: var(--card-shadow-hover);
            transform: translateY(-2px);
        }

        @keyframes slide-in {
            from { transform: translateX(-20px); }
            to { transform: translateX(0); }
        }

        /* Purple curtain highlight effect for searched tasks - MODIFIED to go from inside to outside */
        .task-item.search-highlight {
            position: relative;
            overflow: hidden;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
            animation: search-highlight-border 3s ease forwards;
        }

        .task-item.search-highlight::before,
        .task-item.search-highlight::after {
            content: '';
            position: absolute;
            top: 0;
            height: 100%;
            width: 50%;
            background-color: rgba(79, 70, 229, 0.15);
            z-index: 1;
            animation: curtain-close 0.6s ease forwards, curtain-fade 2.4s ease 0.6s forwards;
        }

        .task-item.search-highlight::before {
            left: 0;
            transform-origin: left center;
        }

        .task-item.search-highlight::after {
            right: 0;
            transform-origin: right center;
        }

        @keyframes curtain-close {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }

        @keyframes curtain-fade {
            0% { opacity: 1; }
            100% { opacity: 0; }
        }

        @keyframes search-highlight-border {
            0% { 
                border-color: var(--primary);
                box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
            }
            70% { 
                border-color: var(--primary);
                box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.2);
            }
            100% { 
                border-color: var(--gray-200);
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            }
        }

        .task-checkbox {
            margin-right: 1.25rem;
        }

        .task-checkbox input {
            appearance: none;
            width: 24px;
            height: 24px;
            border: 2px solid var(--gray-400);
            border-radius: 6px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .task-checkbox input:checked {
            background-color: var(--primary);
            border-color: var(--primary);
        }

        .task-checkbox input:checked::after {
            content: 'âœ“';
            position: absolute;
            color: white;
            font-size: 16px;
            font-weight: bold;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .task-content {
            flex: 1;
        }

        .task-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--gray-800);
            transition: all 0.2s ease;
            font-size: 1.1rem;
        }

        .task-description {
            color: var(--gray-600);
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
        }

        .completed .task-title {
            text-decoration: line-through;
            color: var(--gray-400);
        }

        .completed .task-description {
            color: var(--gray-400);
        }

        .task-meta {
            display: flex;
            font-size: 0.9rem;
            color: var(--gray-500);
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .task-category, .task-date, .task-time {
            display: flex;
            align-items: center;
            padding: 0.3rem 0.75rem;
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .task-category i, .task-date i, .task-time i {
            margin-right: 0.35rem;
            font-size: 0.95rem;
        }

        .task-priority {
            padding: 0.3rem 0.75rem;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }

        .task-actions {
            display: flex;
            gap: 0.75rem;
        }

        .task-action-btn {
            width: 40px;
            height: 40px;
            background-color: white;
            border: 1px solid var(--gray-200);
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--gray-600);
            transition: all 0.3s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            font-size: 1.1rem;
            z-index: 2;
            /* Better touch targets for mobile */
            min-width: 44px;
            min-height: 44px;
        }

        .task-action-btn:hover {
            background-color: var(--gray-100);
            color: var(--primary);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .task-action-btn.edit:hover {
            color: var(--secondary);
        }

        .task-action-btn.delete:hover {
            color: var(--danger);
        }

        /* Category-specific styling */
        .category-work .section-title h2::before {
            background: linear-gradient(135deg, var(--work-color) 0%, var(--work-color) 100%);
        }

        .category-personal .section-title h2::before {
            background: linear-gradient(135deg, var(--personal-color) 0%, var(--personal-color) 100%);
        }

        .category-shopping .section-title h2::before {
            background: linear-gradient(135deg, var(--shopping-color) 0%, var(--shopping-color) 100%);
        }

        .category-health .section-title h2::before {
            background: linear-gradient(135deg, var(--health-color) 0%, var(--health-color) 100%);
        }

        .category-finance .section-title h2::before {
            background: linear-gradient(135deg, var(--finance-color) 0%, var(--finance-color) 100%);
        }

        .category-education .section-title h2::before {
            background: linear-gradient(135deg, var(--education-color) 0%, var(--education-color) 100%);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 3rem 2rem;
            color: var(--gray-500);
            background-color: var(--gray-50);
            border-radius: 12px;
            border: 2px dashed var(--gray-300);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .empty-state:hover {
            border-color: var(--primary);
            background-color: var(--gray-100);
            transform: translateY(-5px);
        }

        .empty-state i {
            font-size: 4.5rem;
            margin-bottom: 1.5rem;
            color: var(--gray-300);
            background: linear-gradient(135deg, var(--gray-300) 0%, var(--gray-400) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state h3 {
            font-size: 1.75rem;
            margin-bottom: 0.5rem;
            color: var(--gray-700);
        }

        .empty-state p {
            font-size: 1.1rem;
            color: var(--gray-500);
        }

        /* Category-specific empty states */
        .empty-state.work i {
            background: linear-gradient(135deg, var(--work-color) 0%, var(--work-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state.personal i {
            background: linear-gradient(135deg, var(--personal-color) 0%, var(--personal-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state.shopping i {
            background: linear-gradient(135deg, var(--shopping-color) 0%, var(--shopping-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state.health i {
            background: linear-gradient(135deg, var(--health-color) 0%, var(--health-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state.finance i {
            background: linear-gradient(135deg, var(--finance-color) 0%, var(--finance-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .empty-state.education i {
            background: linear-gradient(135deg, var(--education-color) 0%, var(--education-color) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Task Detail Modal */
        .task-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .task-detail-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .task-detail-content {
            background-color: white;
            border-radius: 16px;
            width: 90%;
            max-width: 650px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateY(-20px);
            transition: all 0.3s ease;
            overflow: hidden;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .task-detail-modal.active .task-detail-content {
            transform: translateY(0);
        }

        .task-detail-header {
            padding: 1.75rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-gradient);
            color: white;
        }

        .task-detail-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
        }

        .task-detail-close {
            background: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .task-detail-close:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: rotate(90deg);
        }

        .task-detail-body {
            padding: 1.75rem;
            overflow-y: auto;
        }

        .task-detail-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .task-detail-badge {
            display: flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            font-size: 0.9rem;
            font-weight: 500;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .task-detail-badge i {
            margin-right: 0.5rem;
        }

        .task-detail-badge.category {
            background-color: var(--primary-light);
            color: var(--primary-dark);
        }

        .task-detail-badge.category.work {
            background-color: var(--work-light);
            color: var(--work-color);
        }

        .task-detail-badge.category.personal {
            background-color: var(--personal-light);
            color: var(--personal-color);
        }

        .task-detail-badge.category.shopping {
            background-color: var(--shopping-light);
            color: var(--shopping-color);
        }

        .task-detail-badge.category.health {
            background-color: var(--health-light);
            color: var(--health-color);
        }

        .task-detail-badge.category.finance {
            background-color: var(--finance-light);
            color: var(--finance-color);
        }

        .task-detail-badge.category.education {
            background-color: var(--education-light);
            color: var(--education-color);
        }

        .task-detail-badge.priority {
            background-color: var(--success-light);
            color: var(--success);
        }

        .task-detail-badge.priority.medium {
            background-color: var(--warning-light);
            color: var(--warning);
        }

        .task-detail-badge.priority.high {
            background-color: var(--danger-light);
            color: var(--danger);
        }

        .task-detail-badge.date {
            background-color: var(--gray-100);
            color: var(--gray-700);
        }

        .task-detail-badge.time {
            background-color: var(--secondary-light);
            color: var(--secondary-dark);
        }

        .task-detail-badge.status {
            background-color: var(--success-light);
            color: var(--success);
        }

        .task-detail-badge.status.pending {
            background-color: var(--warning-light);
            color: var(--warning);
        }

        .task-detail-badge.reminder {
            background-color: var(--highlight-light);
            color: var(--highlight-color);
        }

        .task-detail-description {
            background-color: var(--gray-50);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--gray-700);
        }

        .task-detail-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: white;
            border-radius: 16px;
            width: 90%;
            max-width: 650px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            transform: translateY(-20px);
            transition: all 0.3s ease;
            overflow: hidden;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: 1.75rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--primary-gradient);
            color: white;
        }

        /* Category-specific modal headers */
        .modal-header.work {
            background: linear-gradient(135deg, var(--work-color) 0%, var(--work-color) 80%);
        }

        .modal-header.personal {
            background: linear-gradient(135deg, var(--personal-color) 0%, var(--personal-color) 80%);
        }

        .modal-header.shopping {
            background: linear-gradient(135deg, var(--shopping-color) 0%, var(--shopping-color) 80%);
        }

        .modal-header.health {
            background: linear-gradient(135deg, var(--health-color) 0%, var(--health-color) 80%);
        }

        .modal-header.finance {
            background: linear-gradient(135deg, var(--finance-color) 0%, var(--finance-color) 80%);
        }

        .modal-header.education {
            background: linear-gradient(135deg, var(--education-color) 0%, var(--education-color) 80%);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
        }

        .modal-close {
            background: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            color: var(--primary);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background-color: rgba(255, 255, 255, 0.9);
            transform: rotate(90deg);
        }

        .modal-body {
            padding: 1.75rem;
            overflow-y: auto;
        }

        /* Confirm Delete Modal */
        .delete-modal .modal-header {
            background: linear-gradient(135deg, var(--danger) 0%, #ff6b6b 100%);
        }

        .delete-modal .modal-close {
            color: var(--danger);
        }

        .delete-icon {
            font-size: 4rem;
            color: var(--danger);
            margin-bottom: 1.5rem;
            text-align: center;
            display: block;
        }

        .delete-message {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.1rem;
            color: var(--gray-700);
        }

        .delete-message strong {
            color: var(--gray-900);
            display: block;
            font-size: 1.2rem;
            margin-top: 0.5rem;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--gray-700);
            font-size: 1.05rem;
        }

        .form-control {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 1.05rem;
            transition: all 0.3s ease;
            background-color: var(--gray-50);
            /* Prevent iOS zoom on input focus */
            font-size: 16px;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
            background-color: white;
        }

        .form-error {
            color: var(--danger);
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .input-group {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-500);
            font-size: 1.1rem;
        }

        .input-with-icon {
            padding-left: 2.75rem;
        }

        /* Datetime input group */
        .datetime-input-group {
            display: flex;
            gap: 1rem;
            align-items: flex-start;
        }

        .date-input {
            flex: 2;
        }

        .time-input {
            flex: 1;
        }

        .time-input-container {
            display: flex;
            flex-direction: column;
        }

        .time-input-field {
            width: 100%;
            padding: 0.9rem 1rem;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 16px; /* Prevent iOS zoom */
            background-color: var(--gray-50);
            transition: all 0.3s ease;
        }

        .time-input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.2);
            background-color: white;
        }

        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
        }

        /* Priority selector */
        .priority-selector {
            display: flex;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .priority-option {
            flex: 1;
            padding: 0.9rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            border: 2px solid var(--gray-200);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            font-size: 1.05rem;
            /* Better touch targets */
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .priority-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .priority-option input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .priority-option.low {
            color: var(--success);
        }

        .priority-option.medium {
            color: var(--warning);
        }

        .priority-option.high {
            color: var(--danger);
        }

        .priority-option.low.selected {
            background-color: var(--success-light);
            border-color: var(--success);
        }

        .priority-option.medium.selected {
            background-color: var(--warning-light);
            border-color: var(--warning);
        }

        .priority-option.high.selected {
            background-color: var(--danger-light);
            border-color: var(--danger);
        }

        .priority-option i {
            margin-right: 0.5rem;
        }

        /* Category selector */
        .category-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .category-option {
            padding: 1rem;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 500;
            border: 2px solid var(--gray-200);
            transition: all 0.3s ease;
            color: var(--gray-700);
            position: relative;
            font-size: 1rem;
            /* Better touch targets */
            min-height: 44px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .category-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .category-option input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .category-option.selected {
            background-color: var(--primary-light);
            border-color: var(--primary);
            color: var(--primary-dark);
        }

        .category-option.work.selected {
            background-color: var(--work-light);
            border-color: var(--work-color);
            color: var(--work-color);
        }

        .category-option.personal.selected {
            background-color: var(--personal-light);
            border-color: var(--personal-color);
            color: var(--personal-color);
        }

        .category-option.shopping.selected {
            background-color: var(--shopping-light);
            border-color: var(--shopping-color);
            color: var(--shopping-color);
        }

        .category-option.health.selected {
            background-color: var(--health-light);
            border-color: var(--health-color);
            color: var(--health-color);
        }

        .category-option.finance.selected {
            background-color: var(--finance-light);
            border-color: var(--finance-color);
            color: var(--finance-color);
        }

        .category-option.education.selected {
            background-color: var(--education-light);
            border-color: var(--education-color);
            color: var(--education-color);
        }

        .category-option i {
            display: block;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        /* Category container transitions */
        .category-container {
            transition: opacity 0.3s ease;
            width: 100%;
        }
        
        .category-container.fade-out {
            opacity: 0;
        }
        
        .category-container.fade-in {
            opacity: 0;
            animation: fade-in 0.3s ease forwards;
        }

        /* Category-specific background styles */
        .task-list.work {
            border-left: 4px solid var(--work-color);
            background-color: rgba(224, 231, 255, 0.3);
        }

        .task-list.personal {
            border-left: 4px solid var(--personal-color);
            background-color: rgba(237, 233, 254, 0.3);
        }

        .task-list.shopping {
            border-left: 4px solid var(--shopping-color);
            background-color: rgba(207, 250, 254, 0.3);
        }

        .task-list.health {
            border-left: 4px solid var(--health-color);
            background-color: rgba(209, 250, 229, 0.3);
        }

        .task-list.finance {
            border-left: 4px solid var(--finance-color);
            background-color: rgba(254, 243, 199, 0.3);
        }

        .task-list.education {
            border-left: 4px solid var(--education-color);
            background-color: rgba(254, 226, 226, 0.3);
        }

      /* Full view styles - UPDATED */
.full-view-active .sidebar {
    transform: translateX(-100%);
    opacity: 0;
    pointer-events: none;
    transition: transform 0.4s ease, opacity 0.4s ease;
}

.full-view-active .main-content {
    gap: 0;
    margin-left: -280px; /* Pull the entire content left to cover sidebar space */
    width: calc(100% + 280px); /* Expand width to fill the sidebar space */
    transition: all 0.4s ease;
}

.full-view-active .tasks-container {
    flex: 1;
    max-width: 100%;
    width: 100%;
    margin-left: 280px; /* Push content back to normal position */
    transition: all 0.4s ease;
}

/* Full view search blur overlay */
.full-view-search-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: 15;
    opacity: 0;
    visibility: hidden;
    transition: all 0.4s ease;
    pointer-events: none;
}

.full-view-search-overlay.active {
    opacity: 1;
    visibility: visible;
    pointer-events: auto;
}

/* Ensure search container stays on top in full view */
.full-view-active .search-container {
    position: relative;
    z-index: 30; /* Higher z-index */
    max-width: 600px;
    margin: 0 auto 1rem auto;
    transition: all 0.4s ease;
}

/* Search suggestions even higher z-index in full view */
.full-view-active .search-suggestions {
    z-index: 35; /* Higher z-index */
}

/* Blur specific elements, NOT the search container */
.full-view-active.search-blur .section-actions {
    filter: blur(4px);
    transition: filter 0.4s ease;
}

.full-view-active.search-blur .task-controls {
    filter: blur(4px);
    transition: filter 0.4s ease;
}

.full-view-active.search-blur .task-filters-wrapper {
    filter: blur(4px);
    transition: filter 0.4s ease;
}

.full-view-active.search-blur .task-list-wrapper {
    filter: blur(4px);
    transition: filter 0.4s ease;
}

.full-view-active.search-blur .dashboard {
    filter: blur(4px);
    transition: filter 0.4s ease;
}

/* EXPLICITLY keep search elements sharp - IMPORTANT */
.full-view-active .search-container,
.full-view-active .search-input,
.full-view-active .search-suggestions,
.full-view-active .search-icon {
    filter: none !important;
    -webkit-filter: none !important;
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
}

/* Enhanced search container in full view when focused */
.full-view-active .search-container.focused {
    transform: scale(1.02);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    z-index: 30; /* Ensure it stays on top */
}

.full-view-active .search-input.focused {
    border-color: var(--primary);
    box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.2);
    background: white;
    filter: none !important; /* Force no filter */
}

/* Dark mode support for blur overlay */
body.dark-mode .full-view-search-overlay {
    background-color: rgba(0, 0, 0, 0.5);
}

body.dark-mode .full-view-active .search-input.focused {
    background: var(--gray-800);
    border-color: var(--primary-light);
}

/* Ensure search suggestions are always visible */
body.dark-mode .full-view-active .search-suggestions {
    background: var(--gray-800);
    filter: none !important;
}

/* Position Add Task and Sort buttons in top right corner */
.full-view-active .section-title {
    position: relative;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: flex-end;
    margin-bottom: 1rem;
    padding-bottom: 0;
    border-bottom: none;
    gap: 0;
    min-height: 60px;
}

.full-view-active .section-actions {
    position: absolute;
    top: -15px; /* Higher at the top */
    right: 0;
    display: flex;
    flex-direction: row !important; /* Force horizontal layout */
    align-items: center;
    justify-content: flex-end; /* Align to the right */
    gap: 0.65rem; /* Slightly bigger gap */
    z-index: 10;
    background: transparent;
    padding: 0;
    border-radius: 0;
    box-shadow: none;
    border: none;
    transform: translateY(0);
    opacity: 1;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    width: auto;
    flex-wrap: nowrap;
}

/* Slightly bigger Sort dropdown with curved edges */
.full-view-active .section-actions .task-sort {
    margin: 0;
    display: flex;
    flex-direction: row;
    align-items: center;
    background: white;
    padding: 0.6rem 0.6rem; /* Slightly bigger horizontal padding */
    box-shadow: var(--card-shadow);
    border: 1px solid var(--gray-200);
    border-radius: 12px; /* Curved edges */
    transition: all 0.3s ease;
    flex-shrink: 0;
    white-space: nowrap;
    font-size: 0.82rem; /* Slightly bigger font */
    height: 40px; /* Same height */
    box-sizing: border-box;
    max-width: fit-content; /* Only as wide as content */
}

.full-view-active .section-actions .sort-label {
    margin-right: 0.35rem; /* Slightly bigger margin */
    font-weight: 500;
    color: var(--gray-600);
    white-space: nowrap;
    font-size: 0.78rem; /* Slightly bigger font */
}

.full-view-active .section-actions .btn-select {
    min-width: 70px; /* Slightly longer width */
    width: 70px; /* Fixed slightly longer width */
    transition: all 0.3s ease;
    border: 1px solid var(--gray-300);
    background: var(--gray-50);
    padding: 0.25rem 0.35rem; /* Slightly bigger padding */
    font-size: 0.78rem; /* Slightly bigger font */
    border-radius: 8px; /* Curved edges for dropdown */
    height: 28px; /* Fixed height for dropdown */
    box-sizing: border-box;
}

/* Slightly bigger Add Task button with curved edges */
.full-view-active .section-actions .btn {
    margin: 0;
    white-space: nowrap;
    transition: all 0.3s ease;
    min-width: 75px; /* Slightly longer width */
    width: auto; /* Let it size to content */
    padding: 0.6rem 0.6rem; /* Slightly bigger horizontal padding */
    box-shadow: var(--card-shadow);
    flex-shrink: 0;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.82rem; /* Slightly bigger font */
    border-radius: 12px; /* Curved edges - same as sort */
    height: 40px; /* Same fixed height as sort */
    box-sizing: border-box;
    max-width: fit-content; /* Only as wide as content */
}

.full-view-active .section-actions .btn .btn-icon {
    margin-right: 0.3rem; /* Slightly bigger icon margin */
    font-size: 0.78rem; /* Slightly bigger icon */
}

/* Hover effects */
.full-view-active .section-actions .task-sort:hover {
    transform: translateY(-1px);
    box-shadow: var(--card-shadow-hover);
    border-color: var(--primary);
}

.full-view-active .section-actions .btn:hover {
    transform: translateY(-1px);
    box-shadow: var(--card-shadow-hover);
}

.full-view-active .section-actions .btn-select:hover {
    border-color: var(--primary);
    background: white;
}

/* Dark mode support */
body.dark-mode .full-view-active .section-actions .task-sort {
    background: var(--gray-800);
    border: 1px solid var(--gray-700);
}

body.dark-mode .full-view-active .section-actions .task-sort:hover {
    background: var(--gray-750);
    border-color: var(--primary-light);
}

body.dark-mode .full-view-active .section-actions .sort-label {
    color: var(--gray-300);
}

body.dark-mode .full-view-active .section-actions .btn-select {
    background: var(--gray-700);
    border-color: var(--gray-600);
    color: var(--gray-200);
}

/* Style the Add Task button separately */
.full-view-active .section-actions .btn {
    margin: 0;
    white-space: nowrap;
    transition: all 0.3s ease;
    min-width: 120px;
    padding: 0.75rem 1.5rem; /* Consistent padding */
    box-shadow: var(--card-shadow); /* Individual shadow */
}

.full-view-active .section-actions .btn:hover {
    transform: translateY(-2px);
    box-shadow: var(--card-shadow-hover);
}

/* Style the sort label and select */
.full-view-active .section-actions .sort-label {
    margin-right: 0.75rem;
    font-weight: 500;
    color: var(--gray-600);
    white-space: nowrap;
}

.full-view-active .section-actions .btn-select {
    min-width: 120px;
    transition: all 0.3s ease;
    border: 1px solid var(--gray-300);
    background: var(--gray-50);
}

.full-view-active .section-actions .btn-select:hover {
    border-color: var(--primary);
    background: white;
}

/* Hide the title and description in full view */
.full-view-active .section-title h2,
.full-view-active .category-description {
    opacity: 0;
    transform: translateY(-10px);
    max-height: 0;
    margin: 0;
    padding: 0;
    overflow: hidden;
    transition: all 0.4s ease;
}

/* Ensure search stays centered */
.full-view-active .search-container {
    max-width: 600px;
    margin: 0 auto 1rem auto;
    position: relative;
    z-index: 5;
    transition: all 0.4s ease;
}

/* Full view button icon change */
.full-view-active #fullViewBtn i {
    transform: rotate(180deg);
    transition: transform 0.3s ease;
}

/* Hide dashboard in full view mode */
.full-view-active .dashboard {
    opacity: 0;
    transform: translateY(-20px);
    max-height: 0;
    margin: 0;
    overflow: hidden;
    transition: all 0.4s ease;
}

/* Better height utilization in full view */
.full-view-active .task-list-wrapper {
    flex: 1;
    height: calc(100vh - 180px);
    overflow-y: auto;
    margin-top: 0;
    transition: all 0.4s ease;
}

.full-view-active .task-list {
    min-height: calc(100vh - 240px);
}

/* Animation for entering full view */
.full-view-active .section-actions .task-sort {
    animation: slideInFromTop 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 0.1s;
}

.full-view-active .section-actions .btn {
    animation: slideInFromTop 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    animation-delay: 0.2s;
}

@keyframes slideInFromTop {
    0% {
        opacity: 0;
        transform: translateY(-20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Dark mode support for the separate buttons */
body.dark-mode .full-view-active .section-actions .task-sort {
    background: var(--gray-800);
    border: 1px solid var(--gray-700);
}

body.dark-mode .full-view-active .section-actions .task-sort:hover {
    background: var(--gray-750);
}

body.dark-mode .full-view-active .section-actions .sort-label {
    color: var(--gray-300);
}

body.dark-mode .full-view-active .section-actions .btn-select {
    background: var(--gray-700);
    border-color: var(--gray-600);
    color: var(--gray-200);
}

        /* Notification System */
        .notification-container {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1500;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .notification {
            padding: 1rem 1.5rem;
            border-radius: 10px;
            background-color: white;
            color: var(--gray-800);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            font-weight: 500;
            display: flex;
            align-items: center;
            transform: translateY(100px);
            opacity: 0;
            transition: transform 0.3s ease, opacity 0.3s ease;
            max-width: 400px;
            width: 100%;
        }

        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }

        .notification-icon {
            margin-right: 0.75rem;
            font-size: 1.25rem;
        }

        .notification.success {
            background-color: var(--success-light);
            color: var(--success);
            border-left: 4px solid var(--success);
        }

        .notification.warning {
            background-color: var(--warning-light);
            color: var(--warning);
            border-left: 4px solid var(--warning);
        }

        .notification.error {
            background-color: var(--danger-light);
            color: var(--danger);
            border-left: 4px solid var(--danger);
        }

        .notification.info {
            background-color: var(--secondary-light);
            color: var(--secondary);
            border-left: 4px solid var(--secondary);
        }

        /* Right slide-in notification for reminders */
        .reminder-notification-container {
            position: fixed;
            bottom: 30px;
            right: -400px; /* Start off-screen */
            z-index: 1600;
            transition: right 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            max-width: 350px;
            width: 100%;
        }

        .reminder-notification-container.show {
            right: 30px;
        }

        .reminder-notification {
            padding: 1.25rem;
            border-radius: 12px;
            background-color: white;
            color: var(--gray-800);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
            border-left: 4px solid var(--highlight-color);
            position: relative;
        }

        .reminder-notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .reminder-notification-title {
            font-weight: 600;
            font-size: 1.15rem;
            color: var(--highlight-color);
            display: flex;
            align-items: center;
        }

        .reminder-notification-title i {
            margin-right: 0.5rem;
        }

        .reminder-notification-close {
            background: transparent;
            border: none;
            color: var(--gray-500);
            cursor: pointer;
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .reminder-notification-close:hover {
            background-color: var(--gray-100);
            color: var(--gray-700);
        }

        .reminder-notification-content {
            font-size: 1rem;
        }

        .reminder-notification-task {
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: 0.25rem;
        }

        .reminder-notification-message {
            color: var(--gray-600);
            margin-bottom: 0.75rem;
        }

        .reminder-notification-actions {
            display: flex;
            justify-content: flex-end;
            gap: 0.75rem;
        }

        .reminder-notification-btn {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .reminder-notification-btn.dismiss {
            background-color: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-200);
        }

        .reminder-notification-btn.dismiss:hover {
            background-color: var(--gray-200);
        }

        .reminder-notification-btn.view {
            background-color: var(--highlight-light);
            color: var(--highlight-color);
            border: 1px solid var(--highlight-color);
        }

        .reminder-notification-btn.view:hover {
            background-color: var(--highlight-color);
            color: white;
        }

        /* Task reminder indicator */
        .task-reminder-indicator {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: var(--highlight-light);
            color: var(--highlight-color);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            border: 2px solid white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            z-index: 5;
        }

        /* Task Form Tabs */
        .task-form-tabs {
            display: flex;
            border-bottom: 1px solid var(--gray-200);
            margin-bottom: 1.5rem;
        }

        .task-form-tab {
            padding: 1rem 1.5rem;
            font-weight: 500;
            cursor: pointer;
            position: relative;
            color: var(--gray-600);
            transition: all 0.3s ease;
            /* Better touch targets */
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        .task-form-tab.active {
            color: var(--primary);
            font-weight: 600;
        }

        .task-form-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--primary);
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
        }

        .task-form-tab:hover:not(.active) {
            color: var(--gray-800);
            background-color: var(--gray-50);
        }

        .task-form-content {
            display: none;
        }

        .task-form-content.active {
            display: block;
        }

        /* NEW REMINDER TOGGLE STYLES */
        .reminder-toggle-container {
            margin-bottom: 1rem;
        }

        .reminder-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem;
            background-color: var(--gray-50);
            border-radius: 12px;
            border: 1px solid var(--gray-200);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reminder-toggle:hover {
            background-color: var(--gray-100);
            border-color: var(--primary);
        }

        .reminder-toggle-label {
            display: flex;
            align-items: center;
            font-weight: 500;
            color: var(--gray-700);
        }

        .reminder-toggle-label i {
            margin-right: 0.75rem;
            font-size: 1.25rem;
            color: var(--highlight-color);
        }

        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            width: 48px;
            height: 24px;
            background-color: var(--gray-300);
            border-radius: 24px;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .toggle-switch.active {
            background-color: var(--highlight-color);
        }

        .toggle-switch-handle {
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-switch-handle {
            transform: translateX(24px);
        }

        /* Reminder Options Container */
        .reminder-options-container {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.4s ease, padding 0.4s ease;
            opacity: 0;
            padding: 0;
        }

        .reminder-options-container.active {
            max-height: 600px;
            opacity: 1;
            padding: 1rem 0;
        }

        /* Reminder Option Styles */
        .reminder-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .reminder-option {
            padding: 1rem;
            border-radius: 10px;
            border: 2px solid var(--gray-200);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            /* Better touch targets */
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .reminder-option:hover {
            transform: translateY(-2px);
            box-shadow: var(--card-shadow);
        }

        .reminder-option.selected {
            background-color: var(--highlight-light);
            border-color: var(--highlight-color);
            color: var(--highlight-color);
        }

        .reminder-option input {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .reminder-option i {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .custom-reminder {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 1rem;
        }

        .custom-reminder-btn {
            background-color: white;
            border: 2px solid var(--gray-300);
            border-radius: 30px;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            color: var(--gray-700);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: fit-content;
            /* Better touch targets */
            min-height: 44px;
        }

        .custom-reminder-btn:hover {
            border-color: var(--highlight-color);
            color: var(--highlight-color);
            transform: translateY(-2px);
            box-shadow: var(--card-shadow);
        }

        .custom-reminder-btn i {
            margin-right: 0.5rem;
        }

        .custom-reminder-form {
            display: none;
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--gray-50);
            border-radius: 10px;
            width: 100%;
        }

        .custom-reminder-form.active {
            display: block;
        }

        .custom-reminder-inputs {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .custom-reminder-inputs > div {
            flex: 1;
            min-width: 80px;
        }

        .custom-reminder-inputs label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--gray-700);
        }

        .custom-reminder-inputs input {
            width: 100%;
            text-align: center;
            padding: 0.6rem;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 16px; /* Prevent iOS zoom */
        }

        .custom-reminder-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .custom-reminder-btn-small {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            /* Better touch targets */
            min-height: 44px;
            display: flex;
            align-items: center;
        }

        .custom-reminder-btn-small.cancel {
            background-color: var(--gray-100);
            color: var(--gray-700);
            border: 1px solid var(--gray-200);
        }

        .custom-reminder-btn-small.cancel:hover {
            background-color: var(--gray-200);
        }

        .custom-reminder-btn-small.apply {
            background-color: var(--highlight-light);
            color: var(--highlight-color);
            border: 1px solid var(--highlight-color);
        }

        .custom-reminder-btn-small.apply:hover {
            background-color: var(--highlight-color);
            color: white;
        }

        /* Mobile styles */
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 992px) {
            .logo span {
                display: block;
            }
            
            .main-content {
                flex-direction: column;
                height: auto;
                gap: 1rem;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 300px;
                margin-bottom: 1.5rem;
                overflow-y: auto;
                position: relative;
                top: 0;
            }
            
            .tasks-container {
                height: auto;
            }

            .section-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .section-title h2 {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 0 0.75rem;
            }

            /* ADD THIS MOBILE CSS HERE */
    .task-controls {
        justify-content: center;
        margin-bottom: 0.5rem;
    }
    
    .task-controls .btn {
        width: 100%;
    }

            /* Welcome screen mobile */
            .app-title {
                font-size: 2rem;
            }

            .welcome-container {
                width: 150px;
                height: 150px;
            }

            .task-card {
                width: 45px;
                height: 45px;
                font-size: 1.2rem;
            }

            /* Header mobile */
            .logo {
                font-size: 1.5rem;
            }

            .logo i {
                width: 36px;
                height: 36px;
                font-size: 1.5rem;
                margin-right: 0.5rem;
            }

            .main-content {
                flex-direction: column;
                margin-top: 0.5rem;
            }

            .sidebar {
                width: 100%;
                position: relative;
                top: 0;
                height: auto;
                max-height: none;
                border-radius: 12px;
                padding: 1rem 0.75rem;
            }

            /* Category options mobile */
            .categories-container {
                overflow-x: auto;
                padding-bottom: 0.5rem;
            }

            .category-slider {
                flex-direction: row;
                gap: 0.5rem;
                min-width: max-content;
            }

            .category {
                white-space: nowrap;
                margin-bottom: 0;
                margin-right: 0.5rem;
                min-width: 120px;
                flex-shrink: 0;
            }

            .active-category-indicator {
                display: none; /* Hide on mobile for horizontal scroll */
            }

            /* Task items mobile */
            .task-item {
                flex-direction: column;
                align-items: flex-start;
                padding: 1rem;
            }

            .task-content {
                width: 100%;
                margin-bottom: 1rem;
            }

            .task-meta {
                margin-bottom: 1rem;
                justify-content: flex-start;
            }

            .task-actions {
                width: 100%;
                justify-content: flex-end;
                align-self: flex-end;
            }

            .dashboard {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .stat-card {
                padding: 1rem;
            }

            .stat-value {
                font-size: 2rem;
            }

            /* Form mobile optimizations */
            .modal-content {
                width: 95%;
                max-height: 85vh;
            }

            .modal-body {
                padding: 1rem;
            }

            .category-selector {
                grid-template-columns: repeat(2, 1fr);
            }

            .priority-selector {
                flex-direction: column;
                gap: 0.75rem;
            }

            .reminder-options {
                grid-template-columns: 1fr;
                gap: 0.75rem;
            }
            
            .datetime-input-group {
                flex-direction: column;
                gap: 1rem;
            }
            
            .time-input {
                width: 100%;
            }

            .custom-reminder-inputs {
                flex-direction: column;
                gap: 0.75rem;
            }

            .form-actions {
                flex-direction: column;
                gap: 0.75rem;
            }

            .btn {
                width: 100%;
            }

            /* Filter buttons mobile */
            .task-filters {
                overflow-x: auto;
                padding-bottom: 0.5rem;
                gap: 0.5rem;
            }

            .filter-btn {
                white-space: nowrap;
                flex-shrink: 0;
            }

            /* Search mobile */
            .search-container {
                max-width: none;
                margin: 0 0 1rem 0;
            }

            .search-input {
                font-size: 16px; /* Prevent iOS zoom */
            }

            /* Notifications mobile */
            .notification-container {
                left: 1rem;
                right: 1rem;
                transform: none;
                bottom: 20px;
            }

            .reminder-notification-container {
                right: -350px;
                max-width: calc(100vw - 2rem);
            }

            .reminder-notification-container.show {
                right: 1rem;
            }

            /* Task detail modal mobile */
            .task-detail-content {
                width: 95%;
                max-height: 85vh;
            }

            .task-detail-body {
                padding: 1rem;
            }

            .task-detail-meta {
                flex-direction: column;
                gap: 0.5rem;
            }

            .task-detail-badge {
                width: fit-content;
            }

            /* Mobile full view styles */
    .full-view-active .tasks-container {
        margin-left: 0;
        padding-left: 0;
    }
    
    .full-view-active .section-title {
        flex-direction: column;
        align-items: stretch;
        gap: 0.5rem;
    }
    
    .full-view-active .section-actions {
        flex-direction: column;
        align-items: stretch;
        gap: 0.5rem;
    }
    
    .full-view-active .section-actions .btn,
    .full-view-active .task-sort {
        width: 100%;
    }
}

            /* Section title mobile */
            .section-title h2 {
                font-size: 1.25rem;
            }

            .section-title h2 i {
                font-size: 1.25rem;
            }

            .category-description {
                font-size: 1rem;
            }

            /* Better spacing for mobile */
            .form-group {
                margin-bottom: 1.25rem;
            }

            .task-form-tabs {
                margin-bottom: 1rem;
            }

            .task-form-tab {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Mobile full view styles */
    .full-view-active .main-content {
        margin-left: 0;
        width: 100%;
    }
    
    .full-view-active .tasks-container {
        margin-left: 0;
    }
    
    .full-view-active .section-actions {
        position: static;
        top: auto;
        right: auto;
        flex-direction: column;
        align-items: stretch;
        gap: 0.5rem;
        background: transparent;
        padding: 0;
        box-shadow: none;
        margin-bottom: 1rem;
    }
    
    .full-view-active .section-actions .btn,
    .full-view-active .task-sort {
        width: 100%;
    }
    
    .full-view-active .search-container {
        margin-bottom: 0.5rem;
    }
}

        @media (max-width: 480px) {
            .app-title {
                font-size: 1.75rem;
            }

            .welcome-container {
                width: 120px;
                height: 120px;
            }

            .task-card {
                width: 35px;
                height: 35px;
                font-size: 1rem;
            }

            .logo {
                font-size: 1.25rem;
            }

            .logo i {
                width: 32px;
                height: 32px;
                font-size: 1.25rem;
            }

            .container {
                padding: 0 0.5rem;
            }

            .sidebar {
                padding: 0.75rem 0.5rem;
            }

            .task-item {
                padding: 0.75rem;
            }

            .modal-content {
                width: 98%;
            }

            .modal-body {
                padding: 0.75rem;
            }

            .task-detail-body {
                padding: 0.75rem;
            }

            .stat-card {
                padding: 0.75rem;
            }

            .category-selector {
                grid-template-columns: 1fr;
            }
        }

        /* Dark Mode Styles */
        body.dark-mode {
            background-color: var(--gray-900);
            color: var(--gray-300);
        }

        body.dark-mode h1, 
        body.dark-mode h2, 
        body.dark-mode h3, 
        body.dark-mode h4, 
        body.dark-mode h5, 
        body.dark-mode h6 {
            color: white;
        }

        body.dark-mode .sidebar,
        body.dark-mode .task-list,
        body.dark-mode .stat-card,
        body.dark-mode .modal-content,
        body.dark-mode .task-sort,
        body.dark-mode .search-suggestions,
        body.dark-mode .task-detail-content,
        body.dark-mode .reminder-notification,
        body.dark-mode .task-filters-wrapper {
            background-color: var(--gray-800);
            border-color: var(--gray-700);
        }

        body.dark-mode .task-filters-wrapper {
            background-color: var(--gray-900);
        }

        body.dark-mode .task-detail-description,
        body.dark-mode .custom-reminder-form,
        body.dark-mode .reminder-toggle {
            background-color: var(--gray-900);
        }

        body.dark-mode .reminder-options-container {
            background-color: var(--gray-800);
        }

        body.dark-mode .suggestion-item:hover {
            background-color: var(--gray-700);
        }

        body.dark-mode .task-item {
            background-color: var(--gray-900);
            border-color: var(--gray-700);
        }

        body.dark-mode .task-item.search-highlight {
            border-color: var(--primary-light);
            box-shadow: 0 0 0 2px rgba(129, 140, 248, 0.2);
        }

        body.dark-mode .task-item.search-highlight::before,
        body.dark-mode .task-item.search-highlight::after {
            background-color: rgba(129, 140, 248, 0.2);
        }

        /* Improved sidebar text visibility in dark mode */
        body.dark-mode .category:not(.active) {
            color: var(--gray-200);
        }

        body.dark-mode .category:hover:not(.active) {
            background-color: rgba(129, 140, 248, 0.2);
            color: white;
        }

        body.dark-mode .search-input,
        body.dark-mode .form-control,
        body.dark-mode .form-select,
        body.dark-mode .custom-reminder-inputs input,
        body.dark-mode .time-input-field {
            background-color: var(--gray-700);
            border-color: var(--gray-600);
            color: var(--gray-200);
        }

        body.dark-mode .search-input:focus,
        body.dark-mode .form-control:focus,
        body.dark-mode .form-select:focus,
        body.dark-mode .custom-reminder-inputs input:focus,
        body.dark-mode .time-input-field:focus {
            background-color: var(--gray-800);
        }

        body.dark-mode .form-label {
            color: var(--gray-300);
        }

        body.dark-mode .empty-state {
            background-color: var(--gray-800);
            border-color: var(--gray-700);
            color: var(--gray-400);
        }

        body.dark-mode .empty-state:hover {
            border-color: var(--primary-light);
            background-color: var(--gray-700);
        }

        body.dark-mode .stat-value {
            color: white;
        }

        body.dark-mode .welcome-overlay {
            background-color: var(--gray-900);
        }

        body.dark-mode .app-container {
            background-color: var(--gray-900);
        }

        body.dark-mode .suggestion-action {
            background-color: var(--gray-700);
        }

        body.dark-mode .task-form-tab:hover:not(.active) {
            background-color: var(--gray-800);
        }

        /* Category-specific backgrounds in dark mode */
        body.dark-mode .task-list.work {
            background-color: rgba(79, 70, 229, 0.1);
        }

        body.dark-mode .task-list.personal {
            background-color: rgba(139, 92, 246, 0.1);
        }

        body.dark-mode .task-list.shopping {
            background-color: rgba(6, 182, 212, 0.1);
        }

        body.dark-mode .task-list.health {
            background-color: rgba(16, 185, 129, 0.1);
        }

        body.dark-mode .task-list.finance {
            background-color: rgba(245, 158, 11, 0.1);
        }

        body.dark-mode .task-list.education {
            background-color: rgba(239, 68, 68, 0.1);
        }

        /* Ensure proper scrolling on iOS */
        @supports (-webkit-overflow-scrolling: touch) {
            .sidebar,
            .task-list-wrapper,
            .search-suggestions,
            .modal-body,
            .task-detail-body {
                -webkit-overflow-scrolling: touch;
            }
        }

        /* Accessibility improvements */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .btn,
            .task-item,
            .category-option,
            .priority-option,
            .reminder-option {
                border-width: 2px;
            }
        }
    </style>
    <!-- Font Awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts - Poppins -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
</head>
<body>
    <!-- Welcome Animation Overlay with Typing Effect -->
    <div class="welcome-overlay" id="welcomeOverlay">
        <div class="welcome-container">
            <div class="task-card">
                <i class="fas fa-briefcase"></i>
            </div>
            <div class="task-card">
                <i class="fas fa-user"></i>
            </div>
            <div class="task-card">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="task-card">
                <i class="fas fa-heartbeat"></i>
            </div>
        </div>
        <div class="app-title">
            Tasklytic<span class="exclamation">!</span>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container" id="appContainer">
        <header>
            <div class="container">
                <div class="logo">
                    <i class="fas fa-tasks"></i>
                    <span>Tasklytic</span>
                </div>
                <div class="header-actions">
                    <button class="theme-toggle" id="themeToggle" aria-label="Toggle Theme">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="container">
            <div class="main-content">
                <aside class="sidebar" id="sidebar">
                    <div class="sidebar-header">
                        <h3>Categories</h3>
                    </div>
                    <div class="categories-container">
                        <!-- Active Category Indicator (Sliding Highlight) -->
                        <div class="active-category-indicator" id="activeCategoryIndicator"></div>
                        
                        <div class="category-slider" id="categorySlider">
                            <div class="category active" data-category="all" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-layer-group"></i>
                                    All Tasks
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="work" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-briefcase"></i>
                                    Work
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="personal" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-user"></i>
                                    Personal
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="shopping" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-shopping-cart"></i>
                                    Shopping
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="health" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-heartbeat"></i>
                                    Health
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="finance" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-dollar-sign"></i>
                                    Finance
                                </div>
                                <div class="task-count">0</div>
                            </div>
                            <div class="category" data-category="education" role="button" tabindex="0">
                                <div class="category-label">
                                    <i class="fas fa-graduation-cap"></i>
                                    Education
                                </div>
                                <div class="task-count">0</div>
                            </div>
                        </div>
                    </div>
                </aside>

                <div class="tasks-container">
                    <div class="tasks-header" id="tasksHeader">
                        <!-- Redesigned Search Container -->
                        <div class="search-container">
                            <i class="fas fa-search search-icon" aria-hidden="true"></i>
                            <input type="text" class="search-input" id="searchInput" placeholder="Search tasks..." aria-label="Search tasks">
                            <div class="search-suggestions" id="searchSuggestions"></div>
                        </div>
                        <div class="search-overlay" id="searchOverlay"></div>

                        <div class="search-overlay" id="searchOverlay"></div>
<div class="full-view-search-overlay" id="fullViewSearchOverlay"></div>
                        
                        <div class="category-container" id="categoryContainer">
                            <div class="section-title">
    <div>
        <h2 id="currentCategory"><i class="fas fa-layer-group"></i> All Tasks</h2>
        <p class="category-description" id="categoryDescription">View and manage all your tasks in one place.</p>
    </div>
    <div class="section-actions">
        <div class="task-sort">
            <span class="sort-label">Sort by:</span>
            <select id="sortSelect" class="btn-select" aria-label="Sort tasks">
                <option value="date">Due Date</option>
                <option value="priority">Priority</option>
                <option value="name">Name</option>
            </select>
        </div>
        <button class="btn btn-primary" id="addTaskBtn" aria-label="Add New Task">
            <i class="fas fa-plus btn-icon" aria-hidden="true"></i> Add Task
        </button>
    </div>
</div>

                    <!-- Dashboard Section - Only shown for "all" category -->
                    <div class="dashboard" id="dashboard">
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-title">Total Tasks</div>
                                <div class="stat-icon total"><i class="fas fa-tasks"></i></div>
                            </div>
                            <div class="stat-value" id="totalTasksValue">0</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i> 5% from last week
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-title">Completed Tasks</div>
                                <div class="stat-icon completed"><i class="fas fa-check-circle"></i></div>
                            </div>
                            <div class="stat-value" id="completedTasksValue">0</div>
                            <div class="stat-change positive">
                                <i class="fas fa-arrow-up"></i> 12% from last week
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-title">Pending Tasks</div>
                                <div class="stat-icon pending"><i class="fas fa-clock"></i></div>
                            </div>
                            <div class="stat-value" id="pendingTasksValue">0</div>
                            <div class="stat-change negative">
                                <i class="fas fa-arrow-down"></i> 3% from last week
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-header">
                                <div class="stat-title">Overdue Tasks</div>
                                <div class="stat-icon overdue"><i class="fas fa-exclamation-circle"></i></div>
                            </div>
                            <div class="stat-value" id="overdueTasksValue">0</div>
                            <div class="stat-change negative">
                                <i class="fas fa-arrow-down"></i> 8% from last week
                            </div>
                        </div>
                    </div>

                    <!-- Add this new container for the full view button -->
<div class="task-controls">
    <button class="btn btn-secondary" id="fullViewBtn" aria-label="Toggle Full View">
        <i class="fas fa-expand btn-icon" aria-hidden="true"></i> Full View
    </button>
</div>

                    <!-- Filter buttons - Now in a wrapper for sticky behavior -->
                    <div class="task-filters-wrapper" id="taskFiltersWrapper">
                        <div class="task-filters" id="taskFilters">
                            <button class="filter-btn active" data-filter="all">All</button>
                            <button class="filter-btn" data-filter="pending">Pending</button>
                            <button class="filter-btn" data-filter="completed">Completed</button>
                            <button class="filter-btn" data-filter="overdue">Overdue</button>
                            <button class="filter-btn" data-filter="today">Due Today</button>
                        </div>
                    </div>

                    <div class="task-list-wrapper" id="taskListWrapper">
                        <div class="task-list" id="taskList" aria-live="polite">
                            <!-- Tasks will be populated here by JavaScript -->
                            <div class="empty-state" id="emptyState">
                                <i class="fas fa-clipboard-list" aria-hidden="true"></i>
                                <h3>No tasks yet</h3>
                                <p>Add your first task to get started</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Task Detail View Modal -->
        <div class="task-detail-modal" id="taskDetailModal" aria-modal="true" role="dialog">
            <div class="task-detail-content">
                <div class="task-detail-header">
                    <h3 class="task-detail-title" id="detailTitle">Task Details</h3>
                    <button class="task-detail-close" id="detailClose" aria-label="Close details">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="task-detail-body">
                    <div class="task-detail-meta" id="detailMeta">
                        <!-- Meta information will be inserted here -->
                    </div>
                    <div class="task-detail-description" id="detailDescription">
                        <!-- Task description will be inserted here -->
                    </div>
                    <div class="task-detail-actions">
                        <button class="btn btn-primary" id="detailEditBtn">
                            <i class="fas fa-pencil-alt btn-icon" aria-hidden="true"></i> Edit Task
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add/Edit Task Modal with Tabs -->
        <div class="modal" id="taskModal" aria-modal="true" role="dialog">
            <div class="modal-content">
                <div class="modal-header" id="modalHeader">
                    <h3 class="modal-title" id="modalTitle">Add New Task</h3>
                    <button class="modal-close" id="modalClose" aria-label="Close modal">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <!-- Task Form Tabs -->
                    <div class="task-form-tabs">
                        <div class="task-form-tab active" data-tab="task-details">Task Details</div>
                        <div class="task-form-tab" data-tab="reminders">Reminders</div>
                    </div>

                    <form id="taskForm">
                        <input type="hidden" id="taskId">
                        <input type="hidden" id="taskReminderTime" value="">
                        <input type="hidden" id="taskReminderMinutes" value="30"> <!-- Store minutes before due time -->

                        <!-- Task Details Tab Content -->
                        <div class="task-form-content active" id="task-details-content">
                            <div class="form-group">
                                <label for="taskTitle" class="form-label">Task Title</label>
                                <div class="input-group">
                                    <i class="fas fa-tasks input-icon" aria-hidden="true"></i>
                                    <input type="text" id="taskTitle" class="form-control input-with-icon" placeholder="What needs to be done?" required>
                                </div>
                                <div class="form-error" id="taskTitleError">Please enter a task title</div>
                            </div>

                            <div class="form-group">
                                <label for="taskDescription" class="form-label">Description (Optional)</label>
                                <textarea id="taskDescription" class="form-control" rows="3" placeholder="Add details about your task..."></textarea>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Category</label>
                                <div class="category-selector" id="categorySelector">
                                    <div class="category-option work">
                                        <input type="radio" name="taskCategory" id="categoryWork" value="work" required>
                                        <i class="fas fa-briefcase"></i>
                                        Work
                                    </div>
                                    <div class="category-option personal">
                                        <input type="radio" name="taskCategory" id="categoryPersonal" value="personal">
                                        <i class="fas fa-user"></i>
                                        Personal
                                    </div>
                                    <div class="category-option shopping">
                                        <input type="radio" name="taskCategory" id="categoryShopping" value="shopping">
                                        <i class="fas fa-shopping-cart"></i>
                                        Shopping
                                    </div>
                                    <div class="category-option health">
                                        <input type="radio" name="taskCategory" id="categoryHealth" value="health">
                                        <i class="fas fa-heartbeat"></i>
                                        Health
                                    </div>
                                    <div class="category-option finance">
                                        <input type="radio" name="taskCategory" id="categoryFinance" value="finance">
                                        <i class="fas fa-dollar-sign"></i>
                                        Finance
                                    </div>
                                    <div class="category-option education">
                                        <input type="radio" name="taskCategory" id="categoryEducation" value="education">
                                        <i class="fas fa-graduation-cap"></i>
                                        Education
                                    </div>
                                </div>
                                <div class="form-error" id="taskCategoryError">Please select a category</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Priority</label>
                                <div class="priority-selector" id="prioritySelector">
                                    <div class="priority-option low">
                                        <input type="radio" name="taskPriority" id="priorityLow" value="low" required>
                                        <i class="fas fa-arrow-down"></i> Low
                                    </div>
                                    <div class="priority-option medium">
                                        <input type="radio" name="taskPriority" id="priorityMedium" value="medium">
                                        <i class="fas fa-equals"></i> Medium
                                    </div>
                                    <div class="priority-option high">
                                        <input type="radio" name="taskPriority" id="priorityHigh" value="high">
                                        <i class="fas fa-arrow-up"></i> High
                                    </div>
                                </div>
                                <div class="form-error" id="taskPriorityError">Please select a priority</div>
                            </div>

                            <div class="form-group">
                                <label class="form-label">Due Date and Time</label>
                                <div class="datetime-input-group">
                                    <div class="date-input">
                                        <div class="input-group">
                                            <i class="fas fa-calendar input-icon" aria-hidden="true"></i>
                                            <input type="date" id="taskDueDate" class="form-control input-with-icon" required>
                                        </div>
                                        <div class="form-error" id="taskDueDateError">Please select a due date</div>
                                    </div>
                                    <div class="time-input">
                                        <div class="time-input-container">
                                            <div class="input-group">
                                                <i class="fas fa-clock input-icon" aria-hidden="true"></i>
                                                <input type="time" id="taskDueTime" class="time-input-field input-with-icon">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Reminders Tab Content with NEW TOGGLE DESIGN -->
                        <div class="task-form-content" id="reminders-content">
                            <div class="form-group">
                                <!-- Reminder Toggle -->
                                <div class="reminder-toggle-container">
                                    <div class="reminder-toggle" id="reminderToggle">
                                        <div class="reminder-toggle-label">
                                            <i class="fas fa-bell"></i>
                                            Set Reminder
                                        </div>
                                        <div class="toggle-switch" id="toggleSwitch">
                                            <div class="toggle-switch-handle"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Reminder Options (Hidden by default) -->
                                <div class="reminder-options-container" id="reminderOptionsContainer">
                                    <div class="reminder-options">
                                        <div class="reminder-option">
                                            <input type="radio" name="reminderOption" id="reminder10min" value="10">
                                            <i class="fas fa-bell"></i>
                                            10 minutes before
                                        </div>
                                        <div class="reminder-option selected">
                                            <input type="radio" name="reminderOption" id="reminder30min" value="30" checked>
                                            <i class="fas fa-bell"></i>
                                            30 minutes before
                                        </div>
                                        <div class="reminder-option">
                                            <input type="radio" name="reminderOption" id="reminder1hour" value="60">
                                            <i class="fas fa-bell"></i>
                                            1 hour before
                                        </div>
                                        <div class="reminder-option">
                                            <input type="radio" name="reminderOption" id="reminder1day" value="1440">
                                            <i class="fas fa-bell"></i>
                                            1 day before
                                        </div>
                                    </div>

                                    <div class="custom-reminder">
                                        <button type="button" class="custom-reminder-btn" id="customReminderBtn">
                                            <i class="fas fa-plus"></i> Custom Reminder
                                        </button>
                                        <div class="custom-reminder-form" id="customReminderForm">
                                            <div class="custom-reminder-inputs">
                                                <div>
                                                    <label for="reminderDays">Days</label>
                                                    <input type="number" id="reminderDays" min="0" max="30" value="0">
                                                </div>
                                                <div>
                                                    <label for="reminderHours">Hours</label>
                                                    <input type="number" id="reminderHours" min="0" max="23" value="0">
                                                </div>
                                                <div>
                                                    <label for="reminderMinutes">Minutes</label>
                                                    <input type="number" id="reminderMinutes" min="0" max="59" value="30">
                                                </div>
                                            </div>
                                            <div class="custom-reminder-actions">
                                                <button type="button" class="custom-reminder-btn-small cancel" id="cancelCustomReminderBtn">Cancel</button>
                                                <button type="button" class="custom-reminder-btn-small apply" id="applyCustomReminderBtn">Apply</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-cancel" id="cancelTaskBtn">Cancel</button>
                            <button type="submit" class="btn btn-primary" id="saveTaskBtn">Save Task</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="modal delete-modal" id="deleteModal" aria-modal="true" role="dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Delete Task</h3>
                    <button class="modal-close" id="deleteModalClose" aria-label="Close delete modal">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="modal-body">
                    <i class="fas fa-trash-alt delete-icon" aria-hidden="true"></i>
                    <p class="delete-message">
                        Are you sure you want to delete this task?
                        <strong id="deleteTaskTitle"></strong>
                        This action cannot be undone.
                    </p>
                    <div class="form-actions">
                        <button type="button" class="btn btn-cancel" id="cancelDeleteBtn">Cancel</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Delete</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification System -->
        <div class="notification-container" id="notificationContainer"></div>

        <!-- Reminder Notification -->
        <div class="reminder-notification-container" id="reminderContainer">
            <div class="reminder-notification">
                <div class="reminder-notification-header">
                    <div class="reminder-notification-title">
                        <i class="fas fa-bell"></i> Task Reminder
                    </div>
                    <button class="reminder-notification-close" id="closeReminderBtn" aria-label="Close reminder">
                        <i class="fas fa-times" aria-hidden="true"></i>
                    </button>
                </div>
                <div class="reminder-notification-content">
                    <div class="reminder-notification-task" id="reminderTaskTitle"></div>
                    <div class="reminder-notification-message" id="reminderMessage"></div>
                    <div class="reminder-notification-actions">
                        <button class="reminder-notification-btn dismiss" id="dismissReminderBtn">Dismiss</button>
                        <button class="reminder-notification-btn view" id="viewReminderTaskBtn">View Task</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JAVASCRIPT -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            'use strict';

            // Theme toggle functionality
            const themeToggle = document.getElementById('themeToggle');
            const body = document.body;
            
            // Check for saved theme preference
            if (localStorage.getItem('theme') === 'dark') {
                body.classList.add('dark-mode');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            }
            
            themeToggle.addEventListener('click', () => {
                body.classList.toggle('dark-mode');
                
                if (body.classList.contains('dark-mode')) {
                    localStorage.setItem('theme', 'dark');
                    themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
                } else {
                    localStorage.setItem('theme', 'light');
                    themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
                }
            });

            // Welcome Animation
            const welcomeOverlay = document.getElementById('welcomeOverlay');
            const appContainer = document.getElementById('appContainer');
            
            setTimeout(() => {
                welcomeOverlay.style.opacity = '0';
                welcomeOverlay.style.visibility = 'hidden';
                appContainer.classList.add('visible');
            }, 3500);

            // Task data storage
            let tasks = JSON.parse(localStorage.getItem('tasks')) || [];
            let currentFilter = 'all';
            let currentCategory = 'all';
            let reminderEnabled = false;

            // Elements
            const categorySlider = document.getElementById('categorySlider');
            const activeCategoryIndicator = document.getElementById('activeCategoryIndicator');
            const currentCategoryEl = document.getElementById('currentCategory');
            const categoryDescriptionEl = document.getElementById('categoryDescription');
            const addTaskBtn = document.getElementById('addTaskBtn');
            const taskModal = document.getElementById('taskModal');
            const modalClose = document.getElementById('modalClose');
            const taskForm = document.getElementById('taskForm');
            const saveTaskBtn = document.getElementById('saveTaskBtn');
            const cancelTaskBtn = document.getElementById('cancelTaskBtn');
            const taskList = document.getElementById('taskList');
            const emptyState = document.getElementById('emptyState');
            const taskFilterBtns = document.querySelectorAll('.filter-btn');
            const searchInput = document.getElementById('searchInput');
            const searchSuggestions = document.getElementById('searchSuggestions');
            const searchOverlay = document.getElementById('searchOverlay');
            const taskDetailModal = document.getElementById('taskDetailModal');
            const detailClose = document.getElementById('detailClose');
            const detailEditBtn = document.getElementById('detailEditBtn');
            const dashboard = document.getElementById('dashboard');
            const deleteModal = document.getElementById('deleteModal');
            const deleteModalClose = document.getElementById('deleteModalClose');
            const cancelDeleteBtn = document.getElementById('cancelDeleteBtn');
            const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
            const notificationContainer = document.getElementById('notificationContainer');
            const reminderContainer = document.getElementById('reminderContainer');
            const closeReminderBtn = document.getElementById('closeReminderBtn');
            const dismissReminderBtn = document.getElementById('dismissReminderBtn');
            const viewReminderTaskBtn = document.getElementById('viewReminderTaskBtn');
            const modalHeader = document.getElementById('modalHeader');
            const categoryOptions = document.querySelectorAll('.category-option');
            const priorityOptions = document.querySelectorAll('.priority-option');
            
            // Task form tabs
            const taskFormTabs = document.querySelectorAll('.task-form-tab');
            const taskFormContents = document.querySelectorAll('.task-form-content');
            
            // NEW: Reminder toggle elements
            const reminderToggle = document.getElementById('reminderToggle');
            const toggleSwitch = document.getElementById('toggleSwitch');
            const reminderOptionsContainer = document.getElementById('reminderOptionsContainer');
            
            // Reminder options
            const reminderOptions = document.querySelectorAll('.reminder-option');
            const customReminderBtn = document.getElementById('customReminderBtn');
            const customReminderForm = document.getElementById('customReminderForm');
            const cancelCustomReminderBtn = document.getElementById('cancelCustomReminderBtn');
            const applyCustomReminderBtn = document.getElementById('applyCustomReminderBtn');
            
            // Dashboard counter elements
            const totalTasksValue = document.getElementById('totalTasksValue');
            const completedTasksValue = document.getElementById('completedTasksValue');
            const pendingTasksValue = document.getElementById('pendingTasksValue');
            const overdueTasksValue = document.getElementById('overdueTasksValue');

            // ADD THIS LINE HERE:
const fullViewBtn = document.getElementById('fullViewBtn');
let isFullView = false;
            
            // Stats for task counts by category
            const taskCountElements = document.querySelectorAll('.task-count');
            
            // Task Filters Sticky Behavior
            const taskFiltersWrapper = document.getElementById('taskFiltersWrapper');
            const taskListWrapper = document.getElementById('taskListWrapper');
            const tasksHeader = document.getElementById('tasksHeader');
            
            // Category descriptions
            const categoryDescriptions = {
                all: 'View and manage all your tasks in one place.',
                work: 'Work tasks related to your job, projects, and professional commitments.',
                personal: 'Personal tasks for your daily life and individual goals.',
                shopping: 'Shopping lists and items you need to purchase.',
                health: 'Health and wellness related tasks including exercise, appointments, and medications.',
                finance: 'Financial tasks like bills, payments, and budget management.',
                education: 'Tasks related to learning, courses, and educational activities.'
            };
            
            // Category icons
            const categoryIcons = {
                all: '<i class="fas fa-layer-group"></i>',
                work: '<i class="fas fa-briefcase"></i>',
                personal: '<i class="fas fa-user"></i>',
                shopping: '<i class="fas fa-shopping-cart"></i>',
                health: '<i class="fas fa-heartbeat"></i>',
                finance: '<i class="fas fa-dollar-sign"></i>',
                education: '<i class="fas fa-graduation-cap"></i>'
            };

            // Initialize the application
            function init() {
                renderTasks();
                updateDashboard();
                updateCategoryCounts();
                
                // Set active category indicator position initially
                const activeCategory = document.querySelector('.category.active');
                if (activeCategory) {
                    updateActiveCategoryIndicator(activeCategory);
                }
                
                checkReminders();
                
                // Check for reminders every minute
                setInterval(checkReminders, 60000);
            }

            // NEW: Reminder Toggle Functionality
            reminderToggle.addEventListener('click', () => {
                reminderEnabled = !reminderEnabled;
                
                if (reminderEnabled) {
                    toggleSwitch.classList.add('active');
                    reminderOptionsContainer.classList.add('active');
                    // Set default reminder if none selected
                    if (!document.querySelector('input[name="reminderOption"]:checked')) {
                        document.getElementById('reminder30min').checked = true;
                        document.querySelector('.reminder-option:nth-child(2)').classList.add('selected');
                        document.getElementById('taskReminderMinutes').value = '30';
                    }
                } else {
                    toggleSwitch.classList.remove('active');
                    reminderOptionsContainer.classList.remove('active');
                    // Clear reminder settings
                    document.getElementById('taskReminderMinutes').value = '';
                    document.getElementById('taskReminderTime').value = '';
                }
            });

            fullViewBtn.addEventListener('click', () => {
    isFullView = !isFullView;
    
    if (isFullView) {
        // Enter full view
        document.body.classList.add('full-view-active');
        fullViewBtn.innerHTML = '<i class="fas fa-compress btn-icon" aria-hidden="true"></i> Exit Full View';
        
        // Make Add Task button shorter text
        addTaskBtn.innerHTML = '<i class="fas fa-plus btn-icon" aria-hidden="true"></i> Add';
        
        // Add smooth transition class
        document.querySelector('.main-content').style.transition = 'all 0.4s ease';
        
        // Hide dashboard regardless of category when in full view
        dashboard.classList.add('hidden');
        
        // If search is currently focused, switch to full view blur
        if (searchInput.classList.contains('focused')) {
            searchOverlay.classList.remove('active');
            fullViewSearchOverlay.classList.add('active');
            document.body.classList.add('search-blur');
        }
        
        showNotification('Full view activated', 'info');
    } else {
        // Exit full view
        document.body.classList.remove('full-view-active');
        document.body.classList.remove('search-blur');
        fullViewBtn.innerHTML = '<i class="fas fa-expand btn-icon" aria-hidden="true"></i> Full View';
        
        // Restore original Add Task button text
        addTaskBtn.innerHTML = '<i class="fas fa-plus btn-icon" aria-hidden="true"></i> Add Task';
        
        // Restore dashboard visibility based on current category
        if (currentCategory === 'all') {
            dashboard.classList.remove('hidden');
        }
        
        // If search is currently focused, switch back to regular overlay
        if (searchInput.classList.contains('focused')) {
            fullViewSearchOverlay.classList.remove('active');
            searchOverlay.classList.add('active');
        }
        
        showNotification('Full view deactivated', 'info');
    }
});
            // Category selection and sliding indicator
            categorySlider.addEventListener('click', (e) => {
                const categoryEl = e.target.closest('.category');
                if (!categoryEl) return;
                
                // Remove active class from all categories
                document.querySelectorAll('.category').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Add active class to clicked category
                categoryEl.classList.add('active');
                
                // Update the sliding indicator position (only on desktop)
                if (window.innerWidth > 768) {
                    updateActiveCategoryIndicator(categoryEl);
                }
                
                // Update current category and tasks
                currentCategory = categoryEl.dataset.category;
                currentCategoryEl.innerHTML = `${categoryIcons[currentCategory]} ${currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1)} Tasks`;
                categoryDescriptionEl.textContent = categoryDescriptions[currentCategory];
                
                // Show/hide dashboard based on category and full view mode
if (currentCategory === 'all' && !isFullView) {
    dashboard.classList.remove('hidden');
} else {
    dashboard.classList.add('hidden');
}
                
                // Update task list
                renderTasks();
            });

            // Update active category indicator position (only for desktop)
            function updateActiveCategoryIndicator(activeCategory) {
                if (window.innerWidth > 768) {
                    activeCategoryIndicator.style.transform = `translateY(${activeCategory.offsetTop}px)`;
                    activeCategoryIndicator.style.height = `${activeCategory.offsetHeight}px`;
                }
            }

            // Add Task button click
            addTaskBtn.addEventListener('click', () => {
                openAddTaskModal();
            });

            // Empty state click
            emptyState.addEventListener('click', () => {
                openAddTaskModal();
            });

            // Open Add Task Modal
            function openAddTaskModal() {
                // Reset the form
                taskForm.reset();
                document.getElementById('taskId').value = '';
                document.getElementById('taskReminderTime').value = '';
                document.getElementById('taskReminderMinutes').value = '';
                
                // Reset reminder toggle
                reminderEnabled = false;
                toggleSwitch.classList.remove('active');
                reminderOptionsContainer.classList.remove('active');
                
                // Set the due date to today by default
                const today = new Date();
                const formattedDate = today.toISOString().substr(0, 10);
                document.getElementById('taskDueDate').value = formattedDate;
                
                // Reset form errors
                document.querySelectorAll('.form-error').forEach(error => {
                    error.style.display = 'none';
                });
                
                // Reset category and priority selections
                document.querySelectorAll('.category-option, .priority-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                // Reset reminder options
                document.querySelectorAll('.reminder-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                // Hide custom reminder form
                customReminderForm.classList.remove('active');
                
                // Reset tab selection to first tab
                taskFormTabs.forEach(tab => tab.classList.remove('active'));
                taskFormContents.forEach(content => content.classList.remove('active'));
                taskFormTabs[0].classList.add('active');
                taskFormContents[0].classList.add('active');
                
                // Pre-select the current category if it's not 'all'
                if (currentCategory !== 'all') {
                    const categoryInput = document.getElementById(`category${currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1)}`);
                    if (categoryInput) {
                        categoryInput.checked = true;
                        document.querySelector(`.category-option.${currentCategory}`).classList.add('selected');
                    }
                }
                
                // Update modal header
                document.getElementById('modalTitle').textContent = 'Add New Task';
                modalHeader.className = 'modal-header';
                
                // Show the modal
                taskModal.classList.add('active');
            }

            // Close Task Modal
            modalClose.addEventListener('click', () => {
                taskModal.classList.remove('active');
            });

            // Cancel Task Button
            cancelTaskBtn.addEventListener('click', () => {
                taskModal.classList.remove('active');
            });

            // Task Form Tabs
            taskFormTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.dataset.tab;
                    
                    // Remove active class from all tabs and contents
                    taskFormTabs.forEach(t => t.classList.remove('active'));
                    taskFormContents.forEach(c => c.classList.remove('active'));
                    
                    // Add active class to clicked tab and its content
                    tab.classList.add('active');
                    document.getElementById(`${tabId}-content`).classList.add('active');
                });
            });

            // Category options selection
            categoryOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Unselect all options
                    categoryOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Select clicked option
                    option.classList.add('selected');
                    
                    // Check the radio button
                    const radio = option.querySelector('input[type="radio"]');
                    if (radio) radio.checked = true;
                    
                    // Update modal header class
                    const category = radio.value;
                    modalHeader.className = `modal-header ${category}`;
                });
            });

            // Priority options selection
            priorityOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Unselect all options
                    priorityOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Select clicked option
                    option.classList.add('selected');
                    
                    // Check the radio button
                    const radio = option.querySelector('input[type="radio"]');
                    if (radio) radio.checked = true;
                });
            });

            // Reminder options selection
            reminderOptions.forEach(option => {
                option.addEventListener('click', () => {
                    // Only allow selection if reminder is enabled
                    if (!reminderEnabled) return;
                    
                    // Unselect all options
                    reminderOptions.forEach(opt => opt.classList.remove('selected'));
                    
                    // Select clicked option
                    option.classList.add('selected');
                    
                    // Check the radio button
                    const radio = option.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        document.getElementById('taskReminderMinutes').value = radio.value;
                    }
                });
            });

            // Custom reminder button
            customReminderBtn.addEventListener('click', () => {
                if (!reminderEnabled) return;
                customReminderForm.classList.toggle('active');
            });

            // Cancel custom reminder
            cancelCustomReminderBtn.addEventListener('click', () => {
                customReminderForm.classList.remove('active');
            });

            // Apply custom reminder
            applyCustomReminderBtn.addEventListener('click', () => {
                const days = parseInt(document.getElementById('reminderDays').value) || 0;
                const hours = parseInt(document.getElementById('reminderHours').value) || 0;
                const minutes = parseInt(document.getElementById('reminderMinutes').value) || 0;
                
                const totalMinutes = (days * 24 * 60) + (hours * 60) + minutes;
                
                // Unselect all options
                reminderOptions.forEach(opt => {
                    opt.classList.remove('selected');
                    opt.querySelector('input[type="radio"]').checked = false;
                });
                
                document.getElementById('taskReminderMinutes').value = totalMinutes;
                
                // Hide custom reminder form
                customReminderForm.classList.remove('active');
                
                // Show notification
                showNotification('Custom reminder set', 'success');
            });

            // Save Task
            taskForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                // Validate form
                let isValid = true;
                
                const title = document.getElementById('taskTitle').value.trim();
                if (!title) {
                    document.getElementById('taskTitleError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('taskTitleError').style.display = 'none';
                }
                
                // Get selected category
                const categoryRadio = document.querySelector('input[name="taskCategory"]:checked');
                if (!categoryRadio) {
                    document.getElementById('taskCategoryError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('taskCategoryError').style.display = 'none';
                }
                
                // Get selected priority
                const priorityRadio = document.querySelector('input[name="taskPriority"]:checked');
                if (!priorityRadio) {
                    document.getElementById('taskPriorityError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('taskPriorityError').style.display = 'none';
                }
                
                // Check due date
                const dueDate = document.getElementById('taskDueDate').value;
                if (!dueDate) {
                    document.getElementById('taskDueDateError').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('taskDueDateError').style.display = 'none';
                }
                
                if (!isValid) return;
                
                // Get form values
                const taskId = document.getElementById('taskId').value;
                const description = document.getElementById('taskDescription').value.trim();
                const category = categoryRadio.value;
                const priority = priorityRadio.value;
                const dueTime = document.getElementById('taskDueTime').value || '23:59';
                const reminderMinutes = reminderEnabled ? (parseInt(document.getElementById('taskReminderMinutes').value) || 0) : 0;
                
                // Create due date time object
                const dueDateObj = new Date(`${dueDate}T${dueTime}`);
                
                // Calculate reminder time
                let reminderTime = null;
                if (reminderEnabled && reminderMinutes > 0) {
                    reminderTime = new Date(dueDateObj.getTime() - (reminderMinutes * 60 * 1000));
                }
                
                if (taskId) {
                    // Update existing task
                    const taskIndex = tasks.findIndex(task => task.id === taskId);
                    if (taskIndex !== -1) {
                        tasks[taskIndex] = {
                            ...tasks[taskIndex],
                            title,
                            description,
                            category,
                            priority,
                            dueDate: dueDateObj.toISOString(),
                            reminderTime: reminderTime ? reminderTime.toISOString() : null,
                            reminderMinutes: reminderEnabled ? reminderMinutes : 0,
                            modifiedAt: new Date().toISOString()
                        };
                        
                        showNotification('Task updated successfully', 'success');
                    }
                } else {
                    // Add new task
                    const newTask = {
                        id: generateId(),
                        title,
                        description,
                        category,
                        priority,
                        completed: false,
                        dueDate: dueDateObj.toISOString(),
                        reminderTime: reminderTime ? reminderTime.toISOString() : null,
                        reminderMinutes: reminderEnabled ? reminderMinutes : 0,
                        createdAt: new Date().toISOString(),
                        modifiedAt: new Date().toISOString()
                    };
                    
                    tasks.push(newTask);
                    showNotification('Task added successfully', 'success');
                }
                
                // Save to localStorage
                saveTasks();
                
                // Close modal
                taskModal.classList.remove('active');
                
                // Re-render tasks
                renderTasks();
                updateDashboard();
                updateCategoryCounts();
            });

            // Filter Task buttons
            taskFilterBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    // Remove active class from all buttons
                    taskFilterBtns.forEach(b => b.classList.remove('active'));
                    
                    // Add active class to clicked button
                    btn.classList.add('active');
                    
                    // Update filter
                    currentFilter = btn.dataset.filter;
                    
                    // Re-render tasks
                    renderTasks();
                });
            });

            // Edit Task
            function editTask(taskId) {
                const task = tasks.find(t => t.id === taskId);
                if (!task) return;
                
                // Set form values
                document.getElementById('taskId').value = task.id;
                document.getElementById('taskTitle').value = task.title;
                document.getElementById('taskDescription').value = task.description || '';
                
                // Set category
                const categoryInput = document.getElementById(`category${task.category.charAt(0).toUpperCase() + task.category.slice(1)}`);
                if (categoryInput) {
                    categoryInput.checked = true;
                    document.querySelectorAll('.category-option').forEach(opt => opt.classList.remove('selected'));
                    document.querySelector(`.category-option.${task.category}`).classList.add('selected');
                }
                
                // Set priority
                const priorityInput = document.getElementById(`priority${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}`);
                if (priorityInput) {
                    priorityInput.checked = true;
                    document.querySelectorAll('.priority-option').forEach(opt => opt.classList.remove('selected'));
                    document.querySelector(`.priority-option.${task.priority}`).classList.add('selected');
                }
                
                // Set due date and time
                const dueDate = new Date(task.dueDate);
                document.getElementById('taskDueDate').value = dueDate.toISOString().substr(0, 10);
                
                // Format time as HH:MM
                const hours = dueDate.getHours().toString().padStart(2, '0');
                const minutes = dueDate.getMinutes().toString().padStart(2, '0');
                document.getElementById('taskDueTime').value = `${hours}:${minutes}`;
                
                // Set reminder
                reminderEnabled = task.reminderMinutes > 0;
                document.getElementById('taskReminderMinutes').value = task.reminderMinutes || '';
                
                if (reminderEnabled) {
                    toggleSwitch.classList.add('active');
                    reminderOptionsContainer.classList.add('active');
                    
                    // Select corresponding reminder option or reset to custom
                    const reminderValue = task.reminderMinutes;
                    let reminderFound = false;
                    
                    reminderOptions.forEach(option => {
                        option.classList.remove('selected');
                        const radio = option.querySelector('input[type="radio"]');
                        radio.checked = false;
                        
                        if (radio.value == reminderValue) {
                            radio.checked = true;
                            option.classList.add('selected');
                            reminderFound = true;
                        }
                    });
                    
                    // If custom reminder
                    if (!reminderFound && reminderValue) {
                        const days = Math.floor(reminderValue / (24 * 60));
                        const hours = Math.floor((reminderValue % (24 * 60)) / 60);
                        const minutes = reminderValue % 60;
                        
                        document.getElementById('reminderDays').value = days;
                        document.getElementById('reminderHours').value = hours;
                        document.getElementById('reminderMinutes').value = minutes;
                    }
                } else {
                    toggleSwitch.classList.remove('active');
                    reminderOptionsContainer.classList.remove('active');
                }
                
                // Set reminder time if exists
                if (task.reminderTime) {
                    document.getElementById('taskReminderTime').value = task.reminderTime;
                }
                
                // Update modal title and header
                document.getElementById('modalTitle').textContent = 'Edit Task';
                modalHeader.className = `modal-header ${task.category}`;
                
                // Reset tab selection to first tab
                taskFormTabs.forEach(tab => tab.classList.remove('active'));
                taskFormContents.forEach(content => content.classList.remove('active'));
                taskFormTabs[0].classList.add('active');
                taskFormContents[0].classList.add('active');
                
                // Show the modal
                taskModal.classList.add('active');
            }

            // Delete Task
            function confirmDeleteTask(taskId) {
                const task = tasks.find(t => t.id === taskId);
                if (!task) return;
                
                // Set task title in confirmation
                document.getElementById('deleteTaskTitle').textContent = task.title;
                
                // Show delete modal
                deleteModal.classList.add('active');
                
                // Set up confirm delete button
                confirmDeleteBtn.onclick = () => {
                    deleteTask(taskId);
                    deleteModal.classList.remove('active');
                };
            }
            
            // Close delete modal
            deleteModalClose.addEventListener('click', () => {
                deleteModal.classList.remove('active');
            });
            
            // Cancel delete
            cancelDeleteBtn.addEventListener('click', () => {
                deleteModal.classList.remove('active');
            });

            // Delete task function
            function deleteTask(taskId) {
                tasks = tasks.filter(task => task.id !== taskId);
                saveTasks();
                renderTasks();
                updateDashboard();
                updateCategoryCounts();
                showNotification('Task deleted successfully', 'success');
            }

            // Toggle task completion
            function toggleTaskCompletion(taskId) {
                const taskIndex = tasks.findIndex(task => task.id === taskId);
                if (taskIndex !== -1) {
                    tasks[taskIndex].completed = !tasks[taskIndex].completed;
                    tasks[taskIndex].modifiedAt = new Date().toISOString();
                    
                    if (tasks[taskIndex].completed) {
                        tasks[taskIndex].completedAt = new Date().toISOString();
                        showNotification('Task completed!', 'success');
                    } else {
                        tasks[taskIndex].completedAt = null;
                    }
                    
                    saveTasks();
                    renderTasks();
                    updateDashboard();
                    updateCategoryCounts();
                }
            }

            // View task details
            function viewTaskDetails(taskId) {
                const task = tasks.find(t => t.id === taskId);
                if (!task) return;
                
                // Set task details
                document.getElementById('detailTitle').textContent = task.title;
                
                // Format meta information
                const metaEl = document.getElementById('detailMeta');
                const dueDate = new Date(task.dueDate);
                
                const formattedDate = new Intl.DateTimeFormat('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                }).format(dueDate);
                
                const formattedTime = new Intl.DateTimeFormat('en-US', {
                    hour: 'numeric',
                    minute: 'numeric',
                    hour12: true
                }).format(dueDate);
                
                metaEl.innerHTML = `
                    <div class="task-detail-badge category ${task.category}">
                        ${categoryIcons[task.category]} ${task.category.charAt(0).toUpperCase() + task.category.slice(1)}
                    </div>
                    <div class="task-detail-badge priority ${task.priority}">
                        <i class="fas fa-flag"></i> ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)} Priority
                    </div>
                    <div class="task-detail-badge date">
                        <i class="fas fa-calendar"></i> ${formattedDate}
                    </div>
                    <div class="task-detail-badge time">
                        <i class="fas fa-clock"></i> ${formattedTime}
                    </div>
                    <div class="task-detail-badge status ${task.completed ? '' : 'pending'}">
                        <i class="fas ${task.completed ? 'fa-check-circle' : 'fa-clock'}"></i>
                        ${task.completed ? 'Completed' : 'Pending'}
                    </div>
                    ${task.reminderMinutes ? `
                        <div class="task-detail-badge reminder">
                            <i class="fas fa-bell"></i> Reminder set
                        </div>
                    ` : ''}
                `;
                
                // Set description
                document.getElementById('detailDescription').textContent = task.description || 'No description provided.';
                
                // Setup edit button
                detailEditBtn.onclick = () => {
                    taskDetailModal.classList.remove('active');
                    editTask(task.id);
                };
                
                // Show the modal
                taskDetailModal.classList.add('active');
            }

            // Close detail modal
            detailClose.addEventListener('click', () => {
                taskDetailModal.classList.remove('active');
            });

            // Generate unique ID
            function generateId() {
                return Date.now().toString(36) + Math.random().toString(36).substr(2);
            }

            // Save tasks to localStorage
            function saveTasks() {
                localStorage.setItem('tasks', JSON.stringify(tasks));
            }

            // Render tasks
            function renderTasks() {
                // Filter tasks based on current category and filter
                let filteredTasks = tasks;
                
                // Filter by category
                if (currentCategory !== 'all') {
                    filteredTasks = filteredTasks.filter(task => task.category === currentCategory);
                }
                
                // Filter by filter type
                if (currentFilter !== 'all') {
                    const today = new Date();
                    today.setHours(0, 0, 0, 0);
                    
                    switch (currentFilter) {
                        case 'pending':
                            filteredTasks = filteredTasks.filter(task => !task.completed);
                            break;
                        case 'completed':
                            filteredTasks = filteredTasks.filter(task => task.completed);
                            break;
                        case 'overdue':
                            filteredTasks = filteredTasks.filter(task => {
                                const dueDate = new Date(task.dueDate);
                                return !task.completed && dueDate < new Date();
                            });
                            break;
                        case 'today':
                            filteredTasks = filteredTasks.filter(task => {
                                const dueDate = new Date(task.dueDate);
                                dueDate.setHours(0, 0, 0, 0);
                                return dueDate.getTime() === today.getTime();
                            });
                            break;
                    }
                }
                
                // Sort tasks by due date (default)
                filteredTasks.sort((a, b) => new Date(a.dueDate) - new Date(b.dueDate));
                
                // Check if there are tasks to display
                if (filteredTasks.length === 0) {
                    // Show empty state
                    taskList.innerHTML = '';
                    
                    // Category-specific empty states
                    let emptyStateClass = '';
                    if (currentCategory !== 'all') {
                        emptyStateClass = currentCategory;
                    }
                    
                    let emptyStateMessage = 'No tasks yet';
                    let emptyStateDescription = 'Add your first task to get started';
                    
                    if (currentFilter !== 'all') {
                        switch (currentFilter) {
                            case 'pending':
                                emptyStateMessage = 'No pending tasks';
                                emptyStateDescription = 'All tasks are completed!';
                                break;
                            case 'completed':
                                emptyStateMessage = 'No completed tasks';
                                emptyStateDescription = 'Complete some tasks to see them here';
                                break;
                            case 'overdue':
                                emptyStateMessage = 'No overdue tasks';
                                emptyStateDescription = "You're on track! Keep it up!";
                                break;
                            case 'today':
                                emptyStateMessage = 'No tasks due today';
                                emptyStateDescription = 'Enjoy your day!';
                                break;
                        }
                    }
                    
                    const emptyStateHtml = `
                        <div class="empty-state ${emptyStateClass}" id="emptyState">
                            <i class="fas fa-clipboard-list" aria-hidden="true"></i>
                            <h3>${emptyStateMessage}</h3>
                            <p>${emptyStateDescription}</p>
                        </div>
                    `;
                    
                    taskList.innerHTML = emptyStateHtml;
                    
                    // Add event listener to empty state
                    document.getElementById('emptyState').addEventListener('click', () => {
                        openAddTaskModal();
                    });
                    
                    return;
                }
                
                // Clear task list
                taskList.innerHTML = '';
                
                // Add category-specific class to task list
                taskList.className = 'task-list';
                if (currentCategory !== 'all') {
                    taskList.classList.add(currentCategory);
                }
                
                // Render each task
                filteredTasks.forEach(task => {
                    const dueDate = new Date(task.dueDate);
                    const formattedDate = new Intl.DateTimeFormat('en-US', {
                        month: 'short',
                        day: 'numeric'
                    }).format(dueDate);
                    
                    const formattedTime = new Intl.DateTimeFormat('en-US', {
                        hour: 'numeric',
                        minute: 'numeric',
                        hour12: true
                    }).format(dueDate);
                    
                    // Check if task is overdue
                    const isOverdue = !task.completed && dueDate < new Date();
                    
                    // Priority classes
                    let priorityClass = '';
                    switch (task.priority) {
                        case 'low':
                            priorityClass = 'success';
                            break;
                        case 'medium':
                            priorityClass = 'warning';
                            break;
                        case 'high':
                            priorityClass = 'danger';
                            break;
                    }
                    
                    // Create task element
                    const taskEl = document.createElement('div');
                    taskEl.className = `task-item ${task.completed ? 'completed' : ''} ${isOverdue ? 'overdue' : ''}`;
                    taskEl.dataset.id = task.id;
                    
                    // Add reminder indicator if task has a reminder
                    const reminderIndicator = task.reminderTime ? `
                        <div class="task-reminder-indicator" title="Reminder set">
                            <i class="fas fa-bell"></i>
                        </div>
                    ` : '';
                    
                    taskEl.innerHTML = `
                        ${reminderIndicator}
                        <div class="task-checkbox">
                            <input type="checkbox" ${task.completed ? 'checked' : ''} aria-label="Mark task as ${task.completed ? 'incomplete' : 'complete'}">
                        </div>
                        <div class="task-content">
                            <div class="task-title">${task.title}</div>
                            ${task.description ? `<div class="task-description">${task.description}</div>` : ''}
                            <div class="task-meta">
                                <div class="task-category">
                                    ${categoryIcons[task.category]} ${task.category.charAt(0).toUpperCase() + task.category.slice(1)}
                                </div>
                                <div class="task-priority task-${task.priority}" style="background-color: var(--${priorityClass}-light); color: var(--${priorityClass});">
                                    ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                                </div>
                                <div class="task-date">
                                    <i class="fas fa-calendar"></i> ${formattedDate}
                                </div>
                                <div class="task-time">
                                    <i class="fas fa-clock"></i> ${formattedTime}
                                </div>
                            </div>
                        </div>
                        <div class="task-actions">
                            <button class="task-action-btn edit" aria-label="Edit task">
                                <i class="fas fa-pencil-alt"></i>
                            </button>
                            <button class="task-action-btn delete" aria-label="Delete task">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
                    
                    // Add event listeners
                    
                    // Complete/uncomplete task
                    const checkbox = taskEl.querySelector('.task-checkbox input');
                    checkbox.addEventListener('change', () => {
                        toggleTaskCompletion(task.id);
                    });
                    
                    // Edit task
                    const editBtn = taskEl.querySelector('.task-action-btn.edit');
                    editBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        editTask(task.id);
                    });
                    
                    // Delete task
                    const deleteBtn = taskEl.querySelector('.task-action-btn.delete');
                    deleteBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        confirmDeleteTask(task.id);
                    });
                    
                    // View task details
                    taskEl.addEventListener('click', (e) => {
                        if (e.target.closest('.task-checkbox') || 
                            e.target.closest('.task-action-btn')) {
                            return;
                        }
                        viewTaskDetails(task.id);
                    });
                    
                    // Add task to list
                    taskList.appendChild(taskEl);
                });
            }

            // Update dashboard
            function updateDashboard() {
                // Calculate task statistics
                const totalTasks = tasks.length;
                const completedTasks = tasks.filter(task => task.completed).length;
                const pendingTasks = tasks.filter(task => !task.completed).length;
                const overdueTasks = tasks.filter(task => {
                    const dueDate = new Date(task.dueDate);
                    return !task.completed && dueDate < new Date();
                }).length;
                
                // Update dashboard values
                totalTasksValue.textContent = totalTasks;
                completedTasksValue.textContent = completedTasks;
                pendingTasksValue.textContent = pendingTasks;
                overdueTasksValue.textContent = overdueTasks;
            }

            // Update category counts
            function updateCategoryCounts() {
                // Count tasks by category
                const categoryCounts = {
                    all: tasks.length,
                    work: tasks.filter(task => task.category === 'work').length,
                    personal: tasks.filter(task => task.category === 'personal').length,
                    shopping: tasks.filter(task => task.category === 'shopping').length,
                    health: tasks.filter(task => task.category === 'health').length,
                    finance: tasks.filter(task => task.category === 'finance').length,
                    education: tasks.filter(task => task.category === 'education').length
                };
                
                // Update category count elements
                taskCountElements.forEach(el => {
                    const category = el.closest('.category').dataset.category;
                    el.textContent = categoryCounts[category] || 0;
                });
            }

            // Check for reminders
            function checkReminders() {
                const now = new Date();
                
                // Find tasks with reminders that are due now
                tasks.forEach(task => {
                    if (task.completed) return;
                    
                    if (task.reminderTime) {
                        const reminderTime = new Date(task.reminderTime);
                        const timeDiff = Math.abs(reminderTime - now);
                        
                        // If within 2 minutes of reminder time and not yet reminded
                        if (timeDiff <= 2 * 60 * 1000 && !task.reminded) {
                            showTaskReminder(task);
                            
                            // Mark as reminded
                            const taskIndex = tasks.findIndex(t => t.id === task.id);
                            if (taskIndex !== -1) {
                                tasks[taskIndex].reminded = true;
                                saveTasks();
                            }
                        }
                    }
                });
            }

            // Show task reminder
            function showTaskReminder(task) {
                const reminderTaskTitle = document.getElementById('reminderTaskTitle');
                const reminderMessage = document.getElementById('reminderMessage');
                
                // Set reminder content
                reminderTaskTitle.textContent = task.title;
                
                // Format date and time
                const dueDate = new Date(task.dueDate);
                const formattedDate = new Intl.DateTimeFormat('en-US', {
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric'
                }).format(dueDate);
                
                const formattedTime = new Intl.DateTimeFormat('en-US', {
                    hour: 'numeric',
                    minute: 'numeric',
                    hour12: true
                }).format(dueDate);
                
                reminderMessage.textContent = `Due on ${formattedDate} at ${formattedTime}`;
                
                // Show reminder
                reminderContainer.classList.add('show');
                
                // Set up view task button
                viewReminderTaskBtn.onclick = () => {
                    reminderContainer.classList.remove('show');
                    viewTaskDetails(task.id);
                };
                
                // Play notification sound if available
                if (window.Audio) {
                    try {
                        // Replace 'path/to/your/audio-file.mp3' with the actual path to your audio file
                        const audio = new Audio('sounds/success-notification.wav');
                        audio.volume = 0.3;
                        audio.play();
                    } catch (e) {
                        console.log('Notification sound not available');
                    }
                }
            }

            // Close reminder
            closeReminderBtn.addEventListener('click', () => {
                reminderContainer.classList.remove('show');
            });
            
            // Dismiss reminder
            dismissReminderBtn.addEventListener('click', () => {
                reminderContainer.classList.remove('show');
            });

            // Show notification
            function showNotification(message, type = 'info') {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                
                let icon = 'info-circle';
                switch (type) {
                    case 'success':
                        icon = 'check-circle';
                        break;
                    case 'warning':
                        icon = 'exclamation-circle';
                        break;
                    case 'error':
                        icon = 'times-circle';
                        break;
                }
                
                notification.innerHTML = `
                    <i class="fas fa-${icon} notification-icon"></i> ${message}
                `;
                
                notificationContainer.appendChild(notification);
                
                // Show notification with a slight delay
                setTimeout(() => {
                    notification.classList.add('show');
                }, 100);
                
                // Remove notification after 3 seconds
                setTimeout(() => {
                    notification.classList.remove('show');
                    
                    // Remove from DOM after animation completes
                    setTimeout(() => {
                        notification.remove();
                    }, 300);
                }, 3000);
            }

            // Updated search functionality with blur effect for full view
const fullViewSearchOverlay = document.getElementById('fullViewSearchOverlay');

searchInput.addEventListener('focus', () => {
    // Add focused class for styling
    searchInput.classList.add('focused');
    searchInput.closest('.search-container').classList.add('focused');
    
    // Show suggestions
    searchSuggestions.classList.add('active');
    
    // In full view mode, show blur overlay and add blur class
    if (isFullView) {
        fullViewSearchOverlay.classList.add('active');
        document.body.classList.add('search-blur');
    } else {
        // Regular mode overlay
        searchOverlay.classList.add('active');
    }
});

// Handle blur (when search loses focus)
searchInput.addEventListener('blur', (e) => {
    // Delay to allow clicking on suggestions
    setTimeout(() => {
        // Remove focused classes
        searchInput.classList.remove('focused');
        searchInput.closest('.search-container').classList.remove('focused');
        
        // Hide suggestions
        searchSuggestions.classList.remove('active');
        
        // Remove blur effects
        if (isFullView) {
            fullViewSearchOverlay.classList.remove('active');
            document.body.classList.remove('search-blur');
        } else {
            searchOverlay.classList.remove('active');
        }
    }, 150);
});

// Handle clicking on overlays to close search
searchOverlay.addEventListener('click', () => {
    searchInput.blur();
    searchSuggestions.classList.remove('active');
    searchOverlay.classList.remove('active');
});

fullViewSearchOverlay.addEventListener('click', () => {
    searchInput.blur();
    searchSuggestions.classList.remove('active');
    fullViewSearchOverlay.classList.remove('active');
    document.body.classList.remove('search-blur');
});

// Update your existing search input event listener
searchInput.addEventListener('input', (e) => {
    const searchTerm = e.target.value.trim().toLowerCase();
    
    if (searchTerm.length === 0) {
        searchSuggestions.innerHTML = '';
        return;
    }
    
    // Filter tasks by search term
    const matchedTasks = tasks.filter(task => 
        task.title.toLowerCase().includes(searchTerm) || 
        (task.description && task.description.toLowerCase().includes(searchTerm))
    );
    
    // Limit to 5 suggestions
    const limitedMatches = matchedTasks.slice(0, 5);
    
    // Clear suggestions
    searchSuggestions.innerHTML = '';
    
    if (limitedMatches.length > 0) {
        limitedMatches.forEach(task => {
            const suggestionItem = document.createElement('div');
            suggestionItem.className = 'suggestion-item';
            suggestionItem.style.borderLeftColor = `var(--${task.category}-color)`;
            
            const dueDate = new Date(task.dueDate);
            const formattedDate = new Intl.DateTimeFormat('en-US', {
                month: 'short',
                day: 'numeric'
            }).format(dueDate);
            
            let priorityClass = '';
            switch (task.priority) {
                case 'low':
                    priorityClass = 'priority-low';
                    break;
                case 'medium':
                    priorityClass = 'priority-medium';
                    break;
                case 'high':
                    priorityClass = 'priority-high';
                    break;
            }
            
            suggestionItem.innerHTML = `
                <div class="suggestion-content">
                    <div class="suggestion-title">${task.title}</div>
                    <div class="suggestion-category">
                        ${categoryIcons[task.category]} ${task.category.charAt(0).toUpperCase() + task.category.slice(1)} â€¢ ${formattedDate}
                    </div>
                </div>
                <div class="suggestion-priority ${priorityClass}">
                    ${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)}
                </div>
                <div class="suggestion-actions">
                    <button class="suggestion-action edit" aria-label="Edit task">
                        <i class="fas fa-pencil-alt"></i>
                    </button>
                    <button class="suggestion-action delete" aria-label="Delete task">
                        <i class="fas fa-trash-alt"></i>
                    </button>
                </div>
            `;
            
            // Add event listeners
            suggestionItem.addEventListener('click', () => {
                viewTaskDetails(task.id);
                searchSuggestions.classList.remove('active');
                if (isFullView) {
                    fullViewSearchOverlay.classList.remove('active');
                    document.body.classList.remove('search-blur');
                } else {
                    searchOverlay.classList.remove('active');
                }
                searchInput.value = '';
            });
            
            // Edit task
            const editBtn = suggestionItem.querySelector('.suggestion-action.edit');
            editBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                editTask(task.id);
                searchSuggestions.classList.remove('active');
                if (isFullView) {
                    fullViewSearchOverlay.classList.remove('active');
                    document.body.classList.remove('search-blur');
                } else {
                    searchOverlay.classList.remove('active');
                }
                searchInput.value = '';
            });
            
            // Delete task
            const deleteBtn = suggestionItem.querySelector('.suggestion-action.delete');
            deleteBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                confirmDeleteTask(task.id);
                searchSuggestions.classList.remove('active');
                if (isFullView) {
                    fullViewSearchOverlay.classList.remove('active');
                    document.body.classList.remove('search-blur');
                } else {
                    searchOverlay.classList.remove('active');
                }
                searchInput.value = '';
            });
            
            searchSuggestions.appendChild(suggestionItem);
        });
    } else {
        searchSuggestions.innerHTML = `
            <div class="suggestion-item" style="justify-content: center; color: var(--gray-500);">
                No tasks found matching "${searchTerm}"
            </div>
        `;
    }
});
            
            // Search form submission - show matching tasks with highlight
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    
                    const searchTerm = searchInput.value.trim().toLowerCase();
                    if (searchTerm.length === 0) return;
                    
                    // Close search suggestions
                    searchSuggestions.classList.remove('active');
                    searchOverlay.classList.remove('active');
                    
                    // Find matching tasks
                    const matchedTasks = tasks.filter(task => 
                        task.title.toLowerCase().includes(searchTerm) || 
                        (task.description && task.description.toLowerCase().includes(searchTerm))
                    );
                    
                    if (matchedTasks.length > 0) {
                        // Switch to "all" category
                        document.querySelectorAll('.category').forEach(cat => {
                            cat.classList.remove('active');
                        });
                        document.querySelector('.category[data-category="all"]').classList.add('active');
                        currentCategory = 'all';
                        currentCategoryEl.innerHTML = `${categoryIcons.all} All Tasks`;
                        categoryDescriptionEl.textContent = `Search results for "${searchTerm}"`;
                        
                        // Reset filter to "all"
                        taskFilterBtns.forEach(btn => {
                            btn.classList.remove('active');
                        });
                        document.querySelector('.filter-btn[data-filter="all"]').classList.add('active');
                        currentFilter = 'all';
                        
                        // Show dashboard
                        dashboard.classList.remove('hidden');
                        
                        // Update the sliding indicator position (only on desktop)
                        if (window.innerWidth > 768) {
                            updateActiveCategoryIndicator(document.querySelector('.category[data-category="all"]'));
                        }
                        
                        // Render all tasks
                        renderTasks();
                        
                        // Highlight matching tasks
                        const taskIds = matchedTasks.map(task => task.id);
                        const taskElements = document.querySelectorAll('.task-item');
                        
                        taskElements.forEach(el => {
                            if (taskIds.includes(el.dataset.id)) {
                                el.classList.add('search-highlight');
                                
                                // Smooth scroll to first match
                                if (el === taskElements[0]) {
                                    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
                                }
                            }
                        });
                        
                        // Show notification
                        showNotification(`Found ${matchedTasks.length} tasks matching "${searchTerm}"`, 'success');
                    } else {
                        showNotification(`No tasks found matching "${searchTerm}"`, 'warning');
                    }
                    
                    // Clear search
                    searchInput.value = '';
                }
            });

            // Handle window resize for mobile optimizations
            window.addEventListener('resize', () => {
                // Update category indicator position on resize (desktop only)
                if (window.innerWidth > 768) {
                    const activeCategory = document.querySelector('.category.active');
                    if (activeCategory) {
                        updateActiveCategoryIndicator(activeCategory);
                    }
                }
            });

            // Close modals when clicking outside on mobile
            [taskModal, taskDetailModal, deleteModal].forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });

            // Prevent zoom on input focus for iOS
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                const inputs = document.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    input.addEventListener('focus', () => {
                        input.style.fontSize = '16px';
                    });
                    input.addEventListener('blur', () => {
                        input.style.fontSize = '';
                    });
                });
            }

            // Initialize the app
            init();
        });
    </script>
</body>
</html>
